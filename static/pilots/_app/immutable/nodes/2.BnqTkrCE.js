import{a as b,t as T,c as de}from"../chunks/disclose-version.CLXa-AFD.js";import{h as we,C as tt,Q as er,a0 as tr,A as rr,b as nr,z as ar,_ as Ot,H as or,B as kt,D as rt,c as Ne,W as ir,as as Ge,F as Dt,a as Nt,G as sr,w as wt,at as lr,au as ur,Z as cr,av as dr,d as fr,O as vr,an as pr,s as xt,aw as _r,ax as mr,ay as yr,T as gr,az as hr,y as br,aA as kr,p as Ut,a6 as U,i as Lt,r as M,v as o,ar as Pe,a7 as d,a9 as c,a8 as u,a5 as O,u as wr,n as dt,e as xr,g as D}from"../chunks/runtime.Bm73Tpmf.js";import{d as Bt,s as A}from"../chunks/render.BfQ3xYTj.js";import{i as G,b as Pr,p as Cr}from"../chunks/this.CnBV6IW7.js";import{s as qt}from"../chunks/snippet.Cwy7Ud8A.js";import{o as Er}from"../chunks/index-client.B3YRV3HL.js";function nt(e,t){return t}function Ir(e,t,r,n){for(var a=[],s=t.length,i=0;i<s;i++)ur(t[i].e,a,!0);var v=s>0&&a.length===0&&r!==null;if(v){var m=r.parentNode;cr(m),m.append(r),n.clear(),xe(e,t[0].prev,t[s-1].next)}dr(a,()=>{for(var E=0;E<s;E++){var S=t[E];v||(n.delete(S.k),xe(e,S.prev,S.next)),fr(S.e,!v)}})}function at(e,t,r,n,a,s=null){var i=e,v={flags:t,items:new Map,first:null};{var m=e;i=we?tt(er(m)):m.appendChild(tr())}we&&rr();var E=null,S=!1;nr(()=>{var p=r(),k=ar(p)?p:p==null?[]:Ot(p),y=k.length;if(S&&y===0)return;S=y===0;let l=!1;if(we){var x=i.data===or;x!==(y===0)&&(i=kt(),tt(i),rt(!1),l=!0)}if(we){for(var I=null,J,_=0;_<y;_++){if(Ne.nodeType===8&&Ne.data===ir){i=Ne,l=!0,rt(!1);break}var g=k[_],f=n(g,_);J=$t(Ne,v,I,null,g,f,_,a,t),v.items.set(f,J),I=J}y>0&&tt(kt())}if(!we){var P=vr;Sr(k,v,i,a,t,(P.f&Ge)!==0,n)}s!==null&&(y===0?E?Dt(E):E=Nt(()=>s(i)):E!==null&&sr(E,()=>{E=null})),l&&rt(!0),r()}),we&&(i=Ne)}function Sr(e,t,r,n,a,s,i,v){var m=e.length,E=t.items,S=t.first,p=S,k,y=null,l=[],x=[],I,J,_,g;for(g=0;g<m;g+=1){if(I=e[g],J=i(I,g),_=E.get(J),_===void 0){var f=p?p.e.nodes_start:r;y=$t(f,t,y,y===null?t.first:y.next,I,J,g,n,a),E.set(J,y),l=[],x=[],p=y.next;continue}if(Tr(_,I,g),_.e.f&Ge&&Dt(_.e),_!==p){if(k!==void 0&&k.has(_)){if(l.length<x.length){var P=x[0],F;y=P.prev;var $=l[0],w=l[l.length-1];for(F=0;F<l.length;F+=1)Pt(l[F],P,r);for(F=0;F<x.length;F+=1)k.delete(x[F]);xe(t,$.prev,w.next),xe(t,y,$),xe(t,w,P),p=P,y=w,g-=1,l=[],x=[]}else k.delete(_),Pt(_,p,r),xe(t,_.prev,_.next),xe(t,_,y===null?t.first:y.next),xe(t,y,_),y=_;continue}for(l=[],x=[];p!==null&&p.k!==J;)(s||!(p.e.f&Ge))&&(k??(k=new Set)).add(p),x.push(p),p=p.next;if(p===null)continue;_=p}l.push(_),y=_,p=_.next}if(p!==null||k!==void 0){for(var h=k===void 0?[]:Ot(k);p!==null;)(s||!(p.e.f&Ge))&&h.push(p),p=p.next;var C=h.length;if(C>0){var z=m===0?r:null;Ir(t,h,z,E)}}wt.first=t.first&&t.first.e,wt.last=y&&y.e}function Tr(e,t,r,n){lr(e.v,t),e.i=r}function $t(e,t,r,n,a,s,i,v,m,E){var S=(m&mr)!==0,p=(m&yr)===0,k=S?p?pr(a):xt(a):a,y=m&_r?xt(i):i,l={i:y,v:k,k:s,a:null,e:null,prev:r,next:n};try{return l.e=Nt(()=>v(e,k,y),we),l.e.prev=r&&r.e,l.e.next=n&&n.e,r===null?t.first=l:(r.next=l,r.e.next=l.e),n!==null&&(n.prev=l,n.e.prev=l.e),l}finally{}}function Pt(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,a=t?t.e.nodes_start:r,s=e.e.nodes_start;s!==n;){var i=gr(s);a.before(s),s=i}}function xe(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Fr(e,t){var r=e.__attributes??(e.__attributes={});r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t)}function Ue(e,t,r,n){var a=e.__attributes??(e.__attributes={});we&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[hr]=r),r==null?e.removeAttribute(t):typeof r!="string"&&zr(e).includes(t)?e[t]=r:e.setAttribute(t,r))}var Ct=new Map;function zr(e){var t=Ct.get(e.nodeName);if(t)return t;Ct.set(e.nodeName,t=[]);for(var r,n=e,a=Element.prototype;a!==n;){r=kr(n);for(var s in r)r[s].set&&t.push(s);n=br(n)}return t}function Ar(e,t,r){if(r){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}function ze(e,t,r,n){var a=e.__styles??(e.__styles={});a[t]!==r&&(a[t]=r,e.style.setProperty(t,r,""))}var Mr=T('<button class="svelte-9gqnah"><i class="material-icons md-36 svelte-9gqnah"> </i></button>'),Rr=T('<div class="svelte-9gqnah"><!> <!></div>');function Or(e,t){Ut(t,!0);let r=Pe(!1),n=Pe(null);const a=()=>{};let s=Pe(a),i=Pe(a),v=Pe(!1);Er(()=>{M(i,()=>{(o(n).requestFullscreen||o(n).mozRequestFullScreen||o(n).webkitRequestFullscreen||o(n).msRequestFullscreen||a).bind(o(n))()}),M(s,Cr((document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen||a).bind(document))),M(v,!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled));const l=document.createElement("link");return l.rel="stylesheet",l.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(l),()=>{l.parentNode.removeChild(l)}});const m=()=>{o(v)&&(o(r)?o(s)():o(i)(o(n)),M(r,!o(r)))};let E=O(()=>o(r)?"fullscreen_exit":"fullscreen");var S=Rr(),p=d(S);qt(p,()=>t.fullscreenable,()=>o(v),()=>m);var k=c(p,2);{var y=l=>{var x=Mr();x.__click=m;var I=d(x),J=d(I,!0);u(I),u(x),U(()=>A(J,o(E))),b(l,x)};G(k,l=>{!t.fullscreenable&&o(v)&&l(y)})}u(S),Pr(S,l=>M(n,l),()=>o(n)),U(()=>Ar(S,"isFull",o(r))),b(e,S),Lt()}Bt(["click"]);const Dr=e=>Math.floor(Math.random()*e),Nr=e=>e[Dr(e.length)],H=(e,t,r)=>Math.min(r,Math.max(e,t)),ot=25,Ur={core:{type:"core",components:["targeter","health"],title:"Core",description:"Processing, control, mechanical center"},bipedalLegs:{type:"bipedalLegs",components:["fuel","stance"],title:"Legs",description:"Stand, shift, and shuffle on two feet"},autopistol:{type:"autopistol",components:["autopistol","targeter"],title:"Gun",description:"Chk chk boom"},sword:{type:"sword",components:["sword","targeter","fuel"],title:"Sword",description:"Schwa-schwa-krang"},shield:{type:"shield",components:["shield","fuel"],title:"Shield",description:"A fancy name for a metal slab"},taser:{type:"taser",components:["targeter","taser","generator","battery"],title:"Taser",description:"Zzztt"},hackingModule:{type:"hackingModule",components:["targeter","hackingModule","hackingToggle","generator","battery"],title:"Taser",description:"Zzztt"}},Le=()=>({parentType:"resource",min:0,max:100,value:100,velocity:0,formatter:e=>Math.trunc(e)}),je=()=>({parentType:"sliderInput",min:0,max:100,value:100,formatter:e=>Math.trunc(e)}),Lr={fuel:{type:"fuel",...Le(),velocity:1},battery:{type:"battery",...Le(),max:1e3,value:200,velocity:-1},generator:{type:"generator",...je(),max:3,value:1,fuelCost:1,batteryGenerationAmount:1,chargeExponent:1.1},taser:{type:"taser",...je(),max:1,value:0,batteryCostRatio:16,damageScaleExponent:1e-4},health:{type:"health",...Le()},autopistol:{type:"autopistol",...Le(),max:3,costPerShot:3,powerPerShot:5,value:0,velocity:.01},sword:{type:"sword",parentType:"unique",costPerSwing:90,baseDamage:25,value:0,min:0,max:100,velocity:1,formatter:e=>Math.trunc(e),swinging:!1},shield:{type:"shield",parentType:"unique",costPer:90,value:0,min:0,max:100,velocity:1.6,totalUses:3,numUses:3,formatter:e=>Math.trunc(e),blocking:!1},stance:{type:"stance",...je(),min:-1,max:1,value:0},targeter:{type:"targeter",parentType:"unique",targetEntityId:null},hackingModule:{type:"hackingModule",...Le(),value:0,max:100,velocity:0,progressPerCharge:1,chargeCost:16,phase:"scanning components",targetedComponentType:null,successChance:.8,resourceLossRatio:6},hackingToggle:{type:"hackingToggle",...je(),value:0,max:1}},q=(e,t,r)=>{e.log.push({timestamp:Ce(),entry:r,level:t}),console.log("Log",e.log.at(-1))},Br=e=>{const t=e.round.state;if(t!=="occurring"&&t!=="paused"){console.error("Paused when round not playing");return}e.round=t==="occurring"?{state:"paused"}:{state:"occurring"}},qr=()=>{const e=Ce();return{mostRecentUpdate:e,round:{state:"not yet started"},log:[],inputChanges:[],remainingLag:0,gameStartedTime:e,entities:[],components:[],parts:[],optimistic:[]}},Ae=(e,t,r)=>{const n=e.components.find(a=>a.entityId===t&&a.type===r);if(n)return Ht(n,r)},N=(e,t,r)=>{const n=e.components.find(a=>a.entityId===t&&a.type===r);if(!n){const a=Re(e,t);throw new Error(`${r}' required for '${a==null?void 0:a.debug}' (${a==null?void 0:a.entityId})`)}return Ht(n,r)},Re=(e,t)=>{let r=e.entities.find(n=>n.entityId===t);return r||(r={debug:"Unknown entity",entityId:-1}),r},Ce=()=>Math.trunc(performance.now()),jt=e=>{const t=Ce();return{...e,round:{state:"occurring"},log:[],gameStartedTime:t,mostRecentUpdate:t}};let $r=0;const Et=(e,t)=>{let r=$r++;return e.entities.push({entityId:r,debug:t}),r},Be=(e,t,r)=>{const n=Ur[r];e.parts.push({...n,entityId:t}),n.components.forEach(a=>{Gt(e,t,a)})},jr=(e,t,r)=>{e.parts=e.parts.filter(n=>!(t===n.entityId&&r===n.type)),Gr(e,t)},Gr=(e,t)=>{e.components=e.components.filter(r=>r.entityId!==t),e.parts.filter(r=>r.entityId===t).forEach(r=>r.components.forEach(n=>{Gt(e,r.entityId,n)}))},Gt=(e,t,r)=>{{let n=Lr[r];if(e.components.find(s=>s.entityId===t&&s.type==r))return;let a={...n,entityId:t};e.components.push(a)}};function Ht(e,t){if(!e)throw new Error;if(e.type!==t)throw Error(`expected tag ${t} but was ${e.type}`);return e}const it=(e,t)=>{e.inputChanges.push(t)},Hr=e=>{const r=Ce()-e.mostRecentUpdate;e.mostRecentUpdate=Ce(),e.remainingLag+=r;let n=0;for(;e.remainingLag>=ot;)if(Kr(e),n++,e.remainingLag-=ot,n>100){q(e,"debug","Lag recovery spinout");break}n>1&&q(e,"debug",`Updated ${n} times to recover from lag`);const a=e.remainingLag/ot;Wr(e,a)},st=(e,t,r)=>{t&&(e.round={state:"over",reason:r})},Kr=e=>{for(;e.inputChanges.length>0;){const t=e.inputChanges.shift(),r=N(e,t.entityId,t.type);if(!r)throw new Error;if(r.parentType==="sliderInput")r.value=H(t.value,r.min,r.max);else if(r.type==="targeter")r.targetEntityId=t.value;else if(r.type==="sword")r.swinging=!0;else if(r.type==="shield")r.blocking=!0;else throw new Error(`Unhandled input type '${t.type}'`);q(e,"debug",`Updated ${t.type} to value ${t.value}`)}e.round.state==="occurring"&&e.components.forEach(t=>{switch(t.parentType){case"resource":{switch(t.type){case"autopistol":{if(t.value<t.costPerShot)break;t.value=t.value-t.costPerShot;const r=N(e,t.entityId,"targeter");if(r.targetEntityId===null)break;const n=N(e,r.targetEntityId,"health");if(n.value===null)break;n.value=H(n.value-t.powerPerShot,n.min,n.max),st(e,n.value<=0,"player lost :(")}break;case"hackingModule":{if(N(e,t.entityId,"hackingToggle").value===0)break;const n=N(e,t.entityId,"battery");if(n.value<t.chargeCost||(n.value=H(n.value-t.chargeCost,n.min,n.max),t.value=H(t.value+t.progressPerCharge,t.min,t.max),t.value<t.max))break;t.value=t.min;let a=!1;const s=N(e,t.entityId,"targeter");if(s.targetEntityId===null)break;if(t.phase==="attempting to disable")if(t.targetedComponentType===null)q(e,"debug","hacking module target was null when attempting to disable"),t.phase="scanning components";else{const i=N(e,s.targetEntityId,t.targetedComponentType);if(!i)q(e,"debug","hacking module target was unavailable when attempting to disable"),t.phase="scanning components";else{const v=Math.random()>t.successChance;switch(i.parentType){case"sliderInput":case"resource":if(v){const m=i.max-i.min,E=i.value;i.value=H(i.value-Math.ceil(m/t.resourceLossRatio),i.min,i.max);const S=i.value;q(e,"debug",`Successfully hacked (${E}->${S}) module type '${i.type}'`)}else q(e,"debug",`Failed to hack module type '${i.type}'`);t.phase="scanning components",t.targetedComponentType=null,a=!0;break;default:q(e,"debug",`hacking module target type '${i.type}' unhackable`),t.phase="scanning components",t.targetedComponentType=null;break}}}if(t.phase==="scanning components"&&!a){const i=e.components.filter(m=>m.entityId===s.targetEntityId&&(m.parentType==="resource"||m.parentType==="sliderInput"));t.targetedComponentType=Nr(i).type;const v=Re(e,s.targetEntityId);t.phase="attempting to disable",q(e,"debug",`hacking module targeted ${v.debug}'s '${t.targetedComponentType}'`),a=!0}a||q(e,"debug","hacking module did nothing")}break}t.value=H(t.value+t.velocity,t.min,t.max)}break;case"sliderInput":switch(t.type){case"taser":{if(t.value<=0)break;const a=N(e,t.entityId,"battery"),s=a.value;if(a.value==null)break;a.value=H(a.value-t.batteryCostRatio*t.value,a.min,a.max);const i=s-a.value,v=N(e,t.entityId,"targeter");if(v.targetEntityId===null)break;const m=N(e,v.targetEntityId,"health");if(m.value===null)break;m.value=H(m.value-i**t.damageScaleExponent,m.min,m.max),st(e,m.value<=0,Re(e,t.entityId).debug+" won!")}break;case"generator":const r=N(e,t.entityId,"fuel"),n=N(e,t.entityId,"battery");for(let a=0;a<t.value;a++){if(r.value<t.fuelCost)return;r.value=H(r.value-t.fuelCost,r.min,r.max),n.value=H(n.value+t.batteryGenerationAmount*(a+1)**t.chargeExponent,n.min,n.max)}break}break;case"unique":switch(t.type){case"sword":{if(t.value=H(t.value+t.velocity,t.min,t.max),!t.swinging)break;if(t.swinging=!1,t.value<t.max){q(e,"debug","Swing attempted before sword was ready");break}const r=N(e,t.entityId,"fuel");if(r.value<t.costPerSwing){q(e,"debug","Swing attempted before fuel cost satisfied");break}const n=N(e,t.entityId,"targeter");if(n.targetEntityId===null){q(e,"debug","Swing attempted but no target");break}r.value-=t.costPerSwing,t.value=t.min;const a=N(e,n.targetEntityId,"health");if(a.value===null)break;a.value=H(a.value-t.baseDamage,a.min,a.max),st(e,a.value<=0,Re(e,t.entityId).debug+" won!")}break;case"shield":{if(t.value=H(t.value+t.velocity,t.min,t.max),!t.blocking)break;if(t.blocking=!1,t.value<t.max){q(e,"debug","Block attempted before shield was ready");break}const r=N(e,t.entityId,"fuel");if(r.value<t.costPer){q(e,"debug","Block attempted before fuel cost satisfied");break}if(t.numUses<=0){q(e,"debug","Block attempted but no remaining uses");break}r.value-=t.costPer,t.value=t.min,t.numUses--,q(e,"debug","Blocked (BLOCKING NOT YET IMPLEMENTED)")}break}}})},Wr=(e,t)=>{e.optimistic={...e.components},Object.entries(e.optimistic).forEach(([r,n])=>{const{parentType:a}=n;switch(a){case"resource":n.value=H(n.value+n.velocity*t,n.min,n.max);break}})};var Yr=T('<meter style="will-change: contents;"> </meter>');function ge(e,t){const r=O(()=>t.component.min),n=O(()=>t.component.max),a=O(()=>t.component.value);let s=O(()=>o(n)-o(r));var i=Yr(),v=d(i);u(i),U(()=>{Ue(i,"min",o(r)),Ue(i,"low",o(s)/2.5+o(r)),Ue(i,"high",o(s)*99/100+o(r)),Ue(i,"optimum",o(s)*99.9/100+o(r)),Ue(i,"max",o(n)),Fr(i,o(a)),A(v,`${o(a)??""} of ${o(n)??""}`)}),b(e,i)}var Kt=Symbol.for("immer-nothing"),It=Symbol.for("immer-draftable"),ae=Symbol.for("immer-state");function fe(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Oe=Object.getPrototypeOf;function De(e){return!!e&&!!e[ae]}function Te(e){var t;return e?Wt(e)||Array.isArray(e)||!!e[It]||!!((t=e.constructor)!=null&&t[It])||Xe(e)||Qe(e):!1}var Zr=Object.prototype.constructor.toString();function Wt(e){if(!e||typeof e!="object")return!1;const t=Oe(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Zr}function Ke(e,t){Ze(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Ze(e){const t=e[ae];return t?t.type_:Array.isArray(e)?1:Xe(e)?2:Qe(e)?3:0}function ft(e,t){return Ze(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Yt(e,t,r){const n=Ze(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Xr(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Xe(e){return e instanceof Map}function Qe(e){return e instanceof Set}function Se(e){return e.copy_||e.base_}function vt(e,t){if(Xe(e))return new Map(e);if(Qe(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Wt(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ae];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const i=a[s],v=n[i];v.writable===!1&&(v.writable=!0,v.configurable=!0),(v.get||v.set)&&(n[i]={configurable:!0,writable:!0,enumerable:v.enumerable,value:e[i]})}return Object.create(Oe(e),n)}else{const n=Oe(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function gt(e,t=!1){return Je(e)||De(e)||!Te(e)||(Ze(e)>1&&(e.set=e.add=e.clear=e.delete=Qr),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>gt(n,!0))),e}function Qr(){fe(2)}function Je(e){return Object.isFrozen(e)}var Jr={};function Fe(e){const t=Jr[e];return t||fe(0,e),t}var qe;function Zt(){return qe}function Vr(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function St(e,t){t&&(Fe("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function pt(e){_t(e),e.drafts_.forEach(en),e.drafts_=null}function _t(e){e===qe&&(qe=e.parent_)}function Tt(e){return qe=Vr(qe,e)}function en(e){const t=e[ae];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ft(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ae].modified_&&(pt(t),fe(4)),Te(e)&&(e=We(t,e),t.parent_||Ye(t,e)),t.patches_&&Fe("Patches").generateReplacementPatches_(r[ae].base_,e,t.patches_,t.inversePatches_)):e=We(t,r,[]),pt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Kt?e:void 0}function We(e,t,r){if(Je(t))return t;const n=t[ae];if(!n)return Ke(t,(a,s)=>zt(e,n,t,a,s,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ye(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let s=a,i=!1;n.type_===3&&(s=new Set(a),a.clear(),i=!0),Ke(s,(v,m)=>zt(e,n,a,v,m,r,i)),Ye(e,a,!1),r&&e.patches_&&Fe("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function zt(e,t,r,n,a,s,i){if(De(a)){const v=s&&t&&t.type_!==3&&!ft(t.assigned_,n)?s.concat(n):void 0,m=We(e,a,v);if(Yt(r,n,m),De(m))e.canAutoFreeze_=!1;else return}else i&&r.add(a);if(Te(a)&&!Je(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;We(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ye(e,a)}}function Ye(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gt(t,r)}function tn(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Zt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=ht;r&&(a=[n],s=$e);const{revoke:i,proxy:v}=Proxy.revocable(a,s);return n.draft_=v,n.revoke_=i,v}var ht={get(e,t){if(t===ae)return e;const r=Se(e);if(!ft(r,t))return rn(e,r,t);const n=r[t];return e.finalized_||!Te(n)?n:n===lt(e.base_,t)?(ut(e),e.copy_[t]=yt(n,e)):n},has(e,t){return t in Se(e)},ownKeys(e){return Reflect.ownKeys(Se(e))},set(e,t,r){const n=Xt(Se(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=lt(Se(e),t),s=a==null?void 0:a[ae];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Xr(r,a)&&(r!==void 0||ft(e.base_,t)))return!0;ut(e),mt(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return lt(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ut(e),mt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Se(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){fe(11)},getPrototypeOf(e){return Oe(e.base_)},setPrototypeOf(){fe(12)}},$e={};Ke(ht,(e,t)=>{$e[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});$e.deleteProperty=function(e,t){return $e.set.call(this,e,t,void 0)};$e.set=function(e,t,r){return ht.set.call(this,e[0],t,r,e[0])};function lt(e,t){const r=e[ae];return(r?Se(r):e)[t]}function rn(e,t,r){var a;const n=Xt(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function Xt(e,t){if(!(t in e))return;let r=Oe(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Oe(r)}}function mt(e){e.modified_||(e.modified_=!0,e.parent_&&mt(e.parent_))}function ut(e){e.copy_||(e.copy_=vt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var nn=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const i=this;return function(m=s,...E){return i.produce(m,S=>r.call(this,S,...E))}}typeof r!="function"&&fe(6),n!==void 0&&typeof n!="function"&&fe(7);let a;if(Te(t)){const s=Tt(this),i=yt(t,void 0);let v=!0;try{a=r(i),v=!1}finally{v?pt(s):_t(s)}return St(s,n),Ft(a,s)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Kt&&(a=void 0),this.autoFreeze_&&gt(a,!0),n){const s=[],i=[];Fe("Patches").generateReplacementPatches_(t,a,s,i),n(s,i)}return a}else fe(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...v)=>this.produceWithPatches(i,m=>t(m,...v));let n,a;return[this.produce(t,r,(i,v)=>{n=i,a=v}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Te(e)||fe(8),De(e)&&(e=an(e));const t=Tt(this),r=yt(e,void 0);return r[ae].isManual_=!0,_t(t),r}finishDraft(e,t){const r=e&&e[ae];(!r||!r.isManual_)&&fe(9);const{scope_:n}=r;return St(n,t),Ft(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Fe("Patches").applyPatches_;return De(e)?n(e,t):this.produce(e,a=>n(a,t))}};function yt(e,t){const r=Xe(e)?Fe("MapSet").proxyMap_(e,t):Qe(e)?Fe("MapSet").proxySet_(e,t):tn(e,t);return(t?t.scope_:Zt()).drafts_.push(r),r}function an(e){return De(e)||fe(10,e),Qt(e)}function Qt(e){if(!Te(e)||Je(e))return e;const t=e[ae];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=vt(e,t.scope_.immer_.useStrictShallowCopy_)}else r=vt(e,!0);return Ke(r,(n,a)=>{Yt(r,n,Qt(a))}),t&&(t.finalized_=!1),r}var oe=new nn,He=oe.produce;oe.produceWithPatches.bind(oe);oe.setAutoFreeze.bind(oe);oe.setUseStrictShallowCopy.bind(oe);oe.applyPatches.bind(oe);oe.createDraft.bind(oe);oe.finishDraft.bind(oe);const Me=(e,t=dt)=>{var r=_n(),n=d(r);qt(n,t),u(r),b(e,r)},At=(e,t,r,n,a)=>{M(t,"play"),M(r,jt(n)),M(a,!0)},on=(e,t,r)=>{M(t,"inventory"),M(r,!1)},sn=(e,t,r)=>{M(t,"store"),M(r,!1)},ln=(e,t,r,n)=>{M(t,jt(r)),M(n,!0)},Mt=(e,t,r)=>{M(t,"play"),M(r,!0)},ct=(e,t,r)=>{M(t,"entry"),M(r,!1)},Rt=(e,t)=>{M(t,He(o(t),r=>{Br(r)}))};var un=T("<label>Auto Pistol Cooldown <!></label>"),cn=T('<div style="will-change: contents"> <!></div>'),dn=T('<div>Health</div> <div style="will-change: contents"> <!></div>',1),fn=T('<div style="will-change: contents"> <!></div>'),vn=T('<div>Sword</div> <label style="display: block;">Cooldown <!></label> <label style="display: block;">Fuel cost <!></label> <button style="border-radius: 9999px; border: 4px inset tomato; background-color: tomato; padding: 1em; display: block; aspect-ratio:1;">Swing</button>',1),pn=T('<div>Shield</div> <label style="display: block;">Cooldown <!></label> <label style="display: block;">Fuel cost <!></label> <label style="display:block;"> <!></label> <button style="border-radius: 9999px; border: 4px inset lightsteelblue; background-color: lightsteelblue; padding: 1em; display: block; aspect-ratio:1;">Block</button>',1),_n=T('<div style="padding: 1em; border: 2px outset;" class="svelte-1jve5dt"><!></div>'),mn=T('<div style="display: flex; flex-direction: column; justify-content: start; align-items: flex-start; padding-bottom: 4em; gap:2em;" class="svelte-1jve5dt"><div class="svelte-1jve5dt"><h1 class="svelte-1jve5dt">Pilots</h1> <h2 class="svelte-1jve5dt">A game about ...?</h2></div> <div><a href="?">Cockpit</a></div> <div><a href="?">Shop</a></div> <div><a href="?">Inventory</a></div> <div><a href="/design">Design notes</a></div></div>'),yn=T('<p><a href="?">Begin</a></p>'),gn=T('<p>Paused. <a href="?">Unpause</a></p>'),hn=T('<!> <div style="border:4px inset; border-radius: 1em; padding: 2em; margin: 2em;" class="svelte-1jve5dt"><h2 class="svelte-1jve5dt">Enemy</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;" class="svelte-1jve5dt"><!> <!></div></div> <h2 class="svelte-1jve5dt">Player</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;" class="svelte-1jve5dt"><!> <!> <!> <!></div>',1),bn=T('<h2 class="svelte-1jve5dt">Game over</h2> <p> </p>',1),kn=T('<a href="?">Toggle Fullscreen</a>'),wn=T('<div class="svelte-1jve5dt"><!> <nav><a href="?">Restart</a> <a href="?">Back To Title</a> <!> <a href="?"> </a></nav></div>'),xn=T('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),Pn=T('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),Cn=T(`<h2 class="svelte-1jve5dt"> </h2> <p style="padding-inline: 4em">This is your inventory where you can see your current parts. You can also rearrange your
        parts to maximize their effectiveness</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <h2 class="svelte-1jve5dt"> </h2> <p style="padding-inline: 4em">This is your enemy's inventory. Do you see what you're up against?</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a></nav>`,1),En=(e,t,r)=>t(o(r)),In=T('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div> <button>Sell</button></div>'),Sn=T('<h2 class="svelte-1jve5dt">The Shop</h2> <p style="padding-inline: 4em">Buy more stuff here.</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a></nav>',1),Tn=T('<main style="width: calc(100vw - 1px); height: 100vh; display: grid; grid-template-rows: 1fr; grid-template-columns: 1fr; justify-items: center; align-items: center;" class="svelte-1jve5dt"><!></main>');function Dn(e,t){Ut(t,!0);const r=_=>{var g=de();const f=O(()=>Ae(o(l),y,"autopistol"));var P=D(g);{var F=w=>{},$=w=>{var h=un(),C=c(d(h));ge(C,{get component(){return o(f)}}),u(h),b(w,h)};G(P,w=>{o(f)?w($,!1):w(F)})}b(_,g)},n=_=>{var g=de();const f=O(()=>Ae(o(l),y,"health"));var P=D(g);{var F=w=>{},$=w=>{var h=cn(),C=d(h);U(()=>A(C,`Health ${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var z=c(C);ge(z,{get component(){return o(f)}}),u(h),b(w,h)};G(P,w=>{o(f)?w($,!1):w(F)})}b(_,g)},a=_=>{var g=de();const f=O(()=>Ae(o(l),k,"health"));var P=D(g);{var F=w=>{},$=w=>{var h=dn(),C=c(D(h),2),z=d(C);U(()=>A(z,`${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var ye=c(z);ge(ye,{get component(){return o(f)}}),u(C),b(w,h)};G(P,w=>{o(f)?w($,!1):w(F)})}b(_,g)},s=_=>{var g=de();const f=O(()=>Ae(o(l),k,"fuel"));var P=D(g);{var F=w=>{},$=w=>{var h=fn(),C=d(h);U(()=>A(C,`Fuel ${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var z=c(C);ge(z,{get component(){return o(f)}}),u(h),b(w,h)};G(P,w=>{o(f)?w($,!1):w(F)})}b(_,g)},i=_=>{var g=de();const f=O(()=>Ae(o(l),k,"sword")),P=O(()=>N(o(l),k,"fuel"));var F=D(g);{var $=h=>{},w=h=>{var C=vn(),z=c(D(C),2),ye=c(d(z));ge(ye,{get component(){return o(f)}}),u(z);var V=c(z,2),ie=c(d(V)),ee=O(()=>({min:o(P).min,max:o(f).costPerSwing,value:H(o(P).value,o(P).min,o(f).costPerSwing)}));ge(ie,{get component(){return o(ee)}}),u(V);var te=c(V,2),he=O(()=>E(o(f).type));te.__click=function(...Ee){var Y;(Y=o(he))==null||Y.apply(this,Ee)},U(()=>te.disabled=o(f).swinging),b(h,C)};G(F,h=>{o(f)?h(w,!1):h($)})}b(_,g)},v=_=>{var g=de();const f=O(()=>Ae(o(l),k,"shield")),P=O(()=>N(o(l),k,"fuel"));var F=D(g);{var $=h=>{},w=h=>{var C=pn(),z=c(D(C),2),ye=c(d(z));ge(ye,{get component(){return o(f)}}),u(z);var V=c(z,2),ie=c(d(V)),ee=O(()=>({min:o(P).min,max:o(f).costPer,value:H(o(P).value,o(P).min,o(f).costPer)}));ge(ie,{get component(){return o(ee)}}),u(V);var te=c(V,2),he=d(te),Ee=c(he),Y=O(()=>({min:0,max:o(f).totalUses,value:o(f).numUses}));ge(Ee,{get component(){return o(Y)}}),u(te);var ce=c(te,2),ve=O(()=>E(o(f).type));ce.__click=function(...be){var se;(se=o(ve))==null||se.apply(this,be)},U(()=>{A(he,`${o(f).numUses??""}/${o(f).totalUses??""} `),ce.disabled=o(f).blocking}),b(h,C)};G(F,h=>{o(f)?h(w,!1):h($)})}b(_,g)},m=(_,g=dt,f=dt)=>{var P=Tn(),F=d(P);{var $=h=>{var C=mn(),z=c(d(C),2),ye=d(z);ye.__click=[At,I,l,p,x],u(z);var V=c(z,2),ie=d(V);ie.__click=[sn,I,x],u(V);var ee=c(V,2),te=d(ee);te.__click=[on,I,x],u(ee),xr(2),u(C),b(h,C)},w=h=>{var C=de(),z=D(C);{var ye=ie=>{var ee=wn(),te=d(ee);{var he=L=>{var K=yn(),_e=d(K);_e.__click=[At,I,l,p,x],u(K),b(L,K)},Ee=L=>{var K=de(),_e=D(K);{var me=R=>{var B=hn(),j=D(B);{var re=Ve=>{var et=gn(),Vt=c(d(et));Vt.__click=[Rt,l],u(et),b(Ve,et)};G(j,Ve=>{o(l).round.state==="paused"&&Ve(re)})}var Z=c(j,2),ne=c(d(Z),2),X=d(ne);Me(X,()=>n);var Q=c(X,2);Me(Q,()=>r),u(ne),u(Z);var le=c(Z,4),ue=d(le);Me(ue,()=>a);var ke=c(ue,2);Me(ke,()=>s);var bt=c(ke,2);Me(bt,()=>i);var Jt=c(bt,2);Me(Jt,()=>v),u(le),b(R,B)},W=R=>{var B=de(),j=D(B);{var re=Z=>{var ne=bn(),X=c(D(ne),2),Q=d(X);u(X),U(()=>A(Q,`Reason: ${o(l).round.reason??""}`)),b(Z,ne)};G(j,Z=>{o(l).round.state==="over"&&Z(re)},!0)}b(R,B)};G(_e,R=>{o(l).round.state==="occurring"||o(l).round.state==="paused"?R(me):R(W,!1)},!0)}b(L,K)};G(te,L=>{o(l).round.state==="not yet started"?L(he):L(Ee,!1)})}var Y=c(te,2),ce=d(Y);ce.__click=[ln,l,p,x];var ve=c(ce,2);ve.__click=[ct,I,x];var be=c(ve,2);{var se=L=>{var K=kn();K.__click=function(..._e){var me;(me=f())==null||me.apply(this,_e)},b(L,K)};G(be,L=>{g()&&L(se)})}var pe=c(be,2);pe.__click=[Rt,l];var Ie=d(pe,!0);u(pe),u(Y),u(ee),U(()=>A(Ie,o(J)?"Unpause (Paused)":"Pause")),b(ie,ee)},V=ie=>{var ee=de(),te=D(ee);{var he=Y=>{var ce=Cn(),ve=D(ce),be=d(ve);U(()=>A(be,`${Re(o(l),k).debug??""}'s Inventory`)),u(ve);var se=c(ve,4);at(se,21,()=>o(l).parts.filter(({entityId:W})=>W===k),nt,(W,R)=>{var B=xn(),j=d(B),re=d(j),Z=d(re,!0);u(re);var ne=c(re,2),X=d(ne,!0);u(ne),u(j);var Q=c(j,2);ze(Q,"font-size","0.8em");var le=d(Q),ue=c(le);ze(ue,"font-size","0.8em");var ke=d(ue,!0);U(()=>A(ke,o(R).components.join(" "))),u(ue),u(Q),u(B),U(()=>{A(Z,o(R).title),A(X,o(R).description),A(le,`${o(R).type??""} `)}),b(W,B)}),u(se);var pe=c(se,2),Ie=d(pe);U(()=>A(Ie,`${Re(o(l),y).debug??""}'s Inventory`)),u(pe);var L=c(pe,4);at(L,21,()=>o(l).parts.filter(({entityId:W})=>W===y),nt,(W,R)=>{var B=Pn(),j=d(B),re=d(j),Z=d(re,!0);u(re);var ne=c(re,2),X=d(ne,!0);u(ne),u(j);var Q=c(j,2);ze(Q,"font-size","0.8em");var le=d(Q),ue=c(le);ze(ue,"font-size","0.8em");var ke=d(ue,!0);U(()=>A(ke,o(R).components.join(" "))),u(ue),u(Q),u(B),U(()=>{A(Z,o(R).title),A(X,o(R).description),A(le,`${o(R).type??""} `)}),b(W,B)}),u(L);var K=c(L,2),_e=d(K);_e.__click=[Mt,I,x];var me=c(_e,2);me.__click=[ct,I,x],u(K),b(Y,ce)},Ee=Y=>{var ce=de(),ve=D(ce);{var be=se=>{var pe=Sn(),Ie=c(D(pe),4);at(Ie,21,()=>o(l).parts.filter(({entityId:me})=>me===k),nt,(me,W)=>{var R=In(),B=d(R),j=d(B),re=d(j,!0);u(j);var Z=c(j,2),ne=d(Z,!0);u(Z),u(B);var X=c(B,2);ze(X,"font-size","0.8em");var Q=d(X),le=c(Q);ze(le,"font-size","0.8em");var ue=d(le,!0);U(()=>A(ue,o(W).components.join(" "))),u(le),u(X);var ke=c(X,2);ke.__click=[En,S,W],u(R),U(()=>{A(re,o(W).title),A(ne,o(W).description),A(Q,`${o(W).type??""} `)}),b(me,R)}),u(Ie);var L=c(Ie,2),K=d(L);K.__click=[Mt,I,x];var _e=c(K,2);_e.__click=[ct,I,x],u(L),b(se,pe)};G(ve,se=>{o(I)==="store"&&se(be)},!0)}b(Y,ce)};G(te,Y=>{o(I)==="inventory"?Y(he):Y(Ee,!1)},!0)}b(ie,ee)};G(z,ie=>{o(I)==="play"?ie(ye):ie(V,!1)},!0)}b(h,C)};G(F,h=>{o(I)==="entry"?h($):h(w,!1)})}u(P),b(_,P)},E=_=>g=>{M(l,He(o(l),f=>{it(f,{entityId:k,type:_,value:"buttonPressed",time:Ce()})}))},S=_=>{M(l,He(o(l),g=>{jr(g,_.entityId,_.type)}))},p=qr(),k=Et(p,"Player");Be(p,k,"core"),Be(p,k,"sword"),Be(p,k,"shield");const y=Et(p,"Enemy");Be(p,y,"core"),Be(p,y,"autopistol"),it(p,{entityId:k,type:"targeter",value:y,time:Ce()}),it(p,{entityId:y,type:"targeter",value:k,time:Ce()});let l=Pe(p),x=Pe(!1);wr(()=>{let _=!1;const g=()=>{o(x)&&M(l,He(o(l),f=>{Hr(f)})),_||requestAnimationFrame(g)};return requestAnimationFrame(g),()=>{_=!0}});let I=Pe("entry");const J=O(()=>o(l).round.state==="paused");Or(e,{fullscreenable:m}),Lt()}Bt(["click"]);export{Dn as component};
