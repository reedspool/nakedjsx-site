var Kr=Object.defineProperty;var ur=t=>{throw TypeError(t)};var Yr=(t,e,r)=>e in t?Kr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var dr=(t,e,r)=>Yr(t,typeof e!="symbol"?e+"":e,r),Tt=(t,e,r)=>e.has(t)||ur("Cannot "+r);var Oe=(t,e,r)=>(Tt(t,e,"read from private field"),r?r.call(t):e.get(t)),nt=(t,e,r)=>e.has(t)?ur("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),At=(t,e,r,n)=>(Tt(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),cr=(t,e,r)=>(Tt(t,e,"access private method"),r);import{a as h,t as F,n as Yt,c as Ie}from"../chunks/disclose-version.BoxAUdT1.js";import{h as Be,C as Ft,Q as Xr,a0 as Zr,A as Qr,b as Jr,z as Vr,_ as zr,H as en,B as fr,D as Rt,c as at,W as tn,as as yt,F as Cr,a as Sr,G as rn,w as vr,at as pr,au as nn,Z as an,av as on,d as sn,O as ln,K as un,aw as Xt,ax as Zt,an as dn,s as yr,ay as Mr,az as cn,aA as fn,T as vn,aB as pn,y as yn,aC as _n,I as gn,k as mn,p as kt,a6 as z,i as Pt,r as S,v as i,ar as Me,a7 as d,a9 as f,a8 as l,a5 as I,g as W,u as hn,n as Ee,e as bn}from"../chunks/runtime.eEmKqtBU.js";import{d as Qt,s as A}from"../chunks/render.DPPUFUww.js";import{i as L,b as xn,p as Ut}from"../chunks/this.xWSyjKSp.js";import{s as Tr}from"../chunks/snippet.3dov3PM9.js";import{o as wn}from"../chunks/index-client.C4k3Pu__.js";function st(t,e){return e}function kn(t,e,r,n){for(var a=[],s=e.length,o=0;o<s;o++)nn(e[o].e,a,!0);var c=s>0&&a.length===0&&r!==null;if(c){var u=r.parentNode;an(u),u.append(r),n.clear(),qe(t,e[0].prev,e[s-1].next)}on(a,()=>{for(var w=0;w<s;w++){var y=e[w];c||(n.delete(y.k),qe(t,y.prev,y.next)),sn(y.e,!c)}})}function lt(t,e,r,n,a,s=null){var o=t,c={flags:e,items:new Map,first:null},u=(e&Mr)!==0;if(u){var w=t;o=Be?Ft(Xr(w)):w.appendChild(Zr())}Be&&Qr();var y=null,U=!1;Jr(()=>{var B=r(),p=Vr(B)?B:B==null?[]:zr(B),v=p.length;if(U&&v===0)return;U=v===0;let b=!1;if(Be){var $=o.data===en;$!==(v===0)&&(o=fr(),Ft(o),Rt(!1),b=!0)}if(Be){for(var M=null,R,q=0;q<v;q++){if(at.nodeType===8&&at.data===tn){o=at,b=!0,Rt(!1);break}var ee=p[q],x=n(ee,q);R=Ar(at,c,M,null,ee,x,q,a,e),c.items.set(x,R),M=R}v>0&&Ft(fr())}if(!Be){var m=ln;Pn(p,c,o,a,e,(m.f&yt)!==0,n)}s!==null&&(v===0?y?Cr(y):y=Sr(()=>s(o)):y!==null&&rn(y,()=>{y=null})),b&&Rt(!0),r()}),Be&&(o=at)}function Pn(t,e,r,n,a,s,o,c){var de,Y,te,ce;var u=(a&cn)!==0,w=(a&(Xt|Zt))!==0,y=t.length,U=e.items,B=e.first,p=B,v,b=null,$,M=[],R=[],q,ee,x,m;if(u)for(m=0;m<y;m+=1)q=t[m],ee=o(q,m),x=U.get(ee),x!==void 0&&((de=x.a)==null||de.measure(),($??($=new Set)).add(x));for(m=0;m<y;m+=1){if(q=t[m],ee=o(q,m),x=U.get(ee),x===void 0){var H=p?p.e.nodes_start:r;b=Ar(H,e,b,b===null?e.first:b.next,q,ee,m,n,a),U.set(ee,b),M=[],R=[],p=b.next;continue}if(w&&In(x,q,m,a),x.e.f&yt&&(Cr(x.e),u&&((Y=x.a)==null||Y.unfix(),($??($=new Set)).delete(x))),x!==p){if(v!==void 0&&v.has(x)){if(M.length<R.length){var k=R[0],E;b=k.prev;var D=M[0],O=M[M.length-1];for(E=0;E<M.length;E+=1)_r(M[E],k,r);for(E=0;E<R.length;E+=1)v.delete(R[E]);qe(e,D.prev,O.next),qe(e,b,D),qe(e,O,k),p=k,b=O,m-=1,M=[],R=[]}else v.delete(x),_r(x,p,r),qe(e,x.prev,x.next),qe(e,x,b===null?e.first:b.next),qe(e,b,x),b=x;continue}for(M=[],R=[];p!==null&&p.k!==ee;)(s||!(p.e.f&yt))&&(v??(v=new Set)).add(p),R.push(p),p=p.next;if(p===null)continue;x=p}M.push(x),b=x,p=x.next}if(p!==null||v!==void 0){for(var G=v===void 0?[]:zr(v);p!==null;)(s||!(p.e.f&yt))&&G.push(p),p=p.next;var le=G.length;if(le>0){var ue=a&Mr&&y===0?r:null;if(u){for(m=0;m<le;m+=1)(te=G[m].a)==null||te.measure();for(m=0;m<le;m+=1)(ce=G[m].a)==null||ce.fix()}kn(e,G,ue,U)}}u&&un(()=>{var Ae;if($!==void 0)for(x of $)(Ae=x.a)==null||Ae.apply()}),vr.first=e.first&&e.first.e,vr.last=b&&b.e}function In(t,e,r,n){n&Xt&&pr(t.v,e),n&Zt?pr(t.i,r):t.i=r}function Ar(t,e,r,n,a,s,o,c,u,w){var y=(u&Xt)!==0,U=(u&fn)===0,B=y?U?dn(a):yr(a):a,p=u&Zt?yr(o):o,v={i:p,v:B,k:s,a:null,e:null,prev:r,next:n};try{return v.e=Sr(()=>c(t,B,p),Be),v.e.prev=r&&r.e,v.e.next=n&&n.e,r===null?e.first=v:(r.next=v,r.e.next=v.e),n!==null&&(n.prev=v,n.e.prev=v.e),v}finally{}}function _r(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,a=e?e.e.nodes_start:r,s=t.e.nodes_start;s!==n;){var o=vn(s);a.before(s),s=o}}function qe(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function En(t,e){var r=t.__attributes??(t.__attributes={});r.value===(r.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e)}function g(t,e,r,n){var a=t.__attributes??(t.__attributes={});Be&&(a[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||a[e]!==(a[e]=r)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[pn]=r),r==null?t.removeAttribute(e):typeof r!="string"&&zn(t).includes(e)?t[e]=r:t.setAttribute(e,r))}var gr=new Map;function zn(t){var e=gr.get(t.nodeName);if(e)return e;gr.set(t.nodeName,e=[]);for(var r,n=t,a=Element.prototype;a!==n;){r=_n(n);for(var s in r)r[s].set&&e.push(s);n=yn(n)}return e}function Cn(t,e,r){if(r){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}function Ze(t,e,r,n){var a=t.__styles??(t.__styles={});a[e]!==r&&(a[e]=r,t.style.setProperty(e,r,""))}var He,Je,ct,xt,Fr;const wt=class wt{constructor(e){nt(this,xt);nt(this,He,new WeakMap);nt(this,Je);nt(this,ct);At(this,ct,e)}observe(e,r){var n=Oe(this,He).get(e)||new Set;return n.add(r),Oe(this,He).set(e,n),cr(this,xt,Fr).call(this).observe(e,Oe(this,ct)),()=>{var a=Oe(this,He).get(e);a.delete(r),a.size===0&&(Oe(this,He).delete(e),Oe(this,Je).unobserve(e))}}};He=new WeakMap,Je=new WeakMap,ct=new WeakMap,xt=new WeakSet,Fr=function(){return Oe(this,Je)??At(this,Je,new ResizeObserver(e=>{for(var r of e){wt.entries.set(r.target,r);for(var n of Oe(this,He).get(r.target)||[])n(r)}}))},dr(wt,"entries",new WeakMap);let Bt=wt;var Sn=new Bt({box:"border-box"});function mr(t,e,r){var n=Sn.observe(t,()=>r(t[e]));gn(()=>(mn(()=>r(t[e])),n))}var Mn=F('<button class="svelte-1vhyctd"><i class="material-icons md-36 svelte-1vhyctd"> </i></button>'),Tn=F('<div class="svelte-1vhyctd"><!> <!></div>');function An(t,e){kt(e,!0);let r=Me(!1),n=Me(null);const a=()=>{};let s=Me(a),o=Me(a),c=Me(!1);wn(()=>{S(o,()=>{(i(n).requestFullscreen||i(n).mozRequestFullScreen||i(n).webkitRequestFullscreen||i(n).msRequestFullscreen||a).bind(i(n))()}),S(s,Ut((document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen||a).bind(document))),S(c,!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(b=>document.addEventListener(b,()=>{S(r,Ut(document.fullscreenElement)),console.log(`Fullscreen updated to ${i(r)?"ON":"OFF"}`)},!1));const v=document.createElement("link");return v.rel="stylesheet",v.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(v),()=>{v.parentNode.removeChild(v)}});const u=()=>{if(i(c)){if(i(r)&&!document.fullscreenElement){console.error("Fullscreen was out of sync"),S(r,!1);return}i(r)?i(s)():i(o)(i(n)),S(r,!i(r))}};let w=I(()=>i(r)?"fullscreen_exit":"fullscreen");var y=Tn(),U=d(y);Tr(U,()=>e.fullscreenable,()=>i(c),()=>i(r),()=>u);var B=f(U,2);{var p=v=>{var b=Mn();b.__click=u;var $=d(b),M=d($,!0);l($),l(b),z(()=>A(M,i(w))),h(v,b)};L(B,v=>{!e.fullscreenable&&i(c)&&v(p)})}l(y),xn(y,v=>S(n,v),()=>i(n)),z(()=>Cn(y,"isFull",i(r))),h(t,y),Pt()}Qt(["click"]);const Fn=t=>Math.floor(Math.random()*t),Rn=t=>t[Fn(t.length)],se=(t,e,r)=>Math.min(r,Math.max(t,e)),_t=25,On={core:{type:"core",components:["targeter","health"],title:"Core",description:"Processing, control, mechanical center"},bipedalLegs:{type:"bipedalLegs",components:["fuel","stance"],title:"Legs",description:"Stand, shift, and shuffle on two feet"},autopistol:{type:"autopistol",components:["autopistol","targeter"],title:"Gun",description:"Chk chk boom"},sword:{type:"sword",components:["sword","targeter","fuel"],title:"Sword",description:"Schwa-schwa-krang"},shield:{type:"shield",components:["shield","fuel"],title:"Shield",description:"A fancy name for a metal slab"},taser:{type:"taser",components:["targeter","taser","generator","battery"],title:"Taser",description:"Zzztt"},hackingModule:{type:"hackingModule",components:["targeter","hackingModule","hackingToggle","generator","battery"],title:"Taser",description:"Zzztt"}},it=()=>({parentType:"resource",min:0,max:100,value:100,velocity:0,formatter:t=>Math.trunc(t)}),pt=()=>({parentType:"sliderInput",min:0,max:100,value:100,formatter:t=>Math.trunc(t)}),Dn={fuel:{type:"fuel",...it(),velocity:1},battery:{type:"battery",...it(),max:1e3,value:200,velocity:-1},generator:{type:"generator",...pt(),max:3,value:1,fuelCost:1,batteryGenerationAmount:1,chargeExponent:1.1},taser:{type:"taser",...pt(),max:1,value:0,batteryCostRatio:16,damageScaleExponent:1e-4},health:{type:"health",...it()},autopistol:{type:"autopistol",...it(),max:3,costPerShot:3,powerPerShot:5,value:0,velocity:.01},sword:{type:"sword",parentType:"unique",costPerSwing:90,baseDamage:25,value:0,min:0,max:100,velocity:1,formatter:t=>Math.trunc(t),swinging:!1,ready:!1},shield:{type:"shield",parentType:"unique",costPer:90,value:0,min:0,max:100,velocity:1.6,totalUses:3,numUses:3,formatter:t=>Math.trunc(t),blocking:!1,blockedAt:null,blockDuration:_t*10},stance:{type:"stance",...pt(),min:-1,max:1,value:0},targeter:{type:"targeter",parentType:"unique",targetEntityId:null},hackingModule:{type:"hackingModule",...it(),value:0,max:100,velocity:0,progressPerCharge:1,chargeCost:16,phase:"scanning components",targetedComponentType:null,successChance:.8,resourceLossRatio:6},hackingToggle:{type:"hackingToggle",...pt(),value:0,max:1}},K=(t,e,r)=>{t.log.push({timestamp:Te(),entry:r,level:e}),console.log("Log",t.log.at(-1))},$n=t=>{const e=t.round.state;if(e!=="occurring"&&e!=="paused"){console.error("Paused when round not playing");return}t.round=e==="occurring"?{state:"paused"}:{state:"occurring"}},Nn=()=>{const t=Te();return{mostRecentUpdate:t,round:{state:"not yet started"},log:[],inputChanges:[],remainingLag:0,gameStartedTime:t,entities:[],components:[],parts:[],optimistic:[]}},Ln=(t,e,r)=>{const n=t.components.find(a=>a.entityId===e&&a.type===r);if(n)return Dr(n,r)},Z=(t,e,r)=>{const n=t.components.find(a=>a.entityId===e&&a.type===r);if(!n){const a=Ve(t,e);throw new Error(`${r}' required for '${a==null?void 0:a.debug}' (${a==null?void 0:a.entityId})`)}return Dr(n,r)},Ve=(t,e)=>{let r=t.entities.find(n=>n.entityId===e);return r||(r={debug:"Unknown entity",entityId:-1}),r},Te=()=>Math.trunc(performance.now()),Rr=t=>{const e=Te();return{...t,round:{state:"occurring"},log:[],gameStartedTime:e,mostRecentUpdate:e}};let Un=0;const hr=(t,e)=>{let r=Un++;return t.entities.push({entityId:r,debug:e}),r},ot=(t,e,r)=>{const n=On[r];t.parts.push({...n,entityId:e}),n.components.forEach(a=>{Or(t,e,a)})},Bn=(t,e,r)=>{t.parts=t.parts.filter(n=>!(e===n.entityId&&r===n.type)),qn(t,e)},qn=(t,e)=>{t.components=t.components.filter(r=>r.entityId!==e),t.parts.filter(r=>r.entityId===e).forEach(r=>r.components.forEach(n=>{Or(t,r.entityId,n)}))},Or=(t,e,r)=>{{let n=Dn[r];if(t.components.find(s=>s.entityId===e&&s.type==r))return;let a={...n,entityId:e};t.components.push(a)}};function Dr(t,e){if(!t)throw new Error;if(t.type!==e)throw Error(`expected tag ${e} but was ${t.type}`);return t}const Ot=(t,e)=>{t.inputChanges.push(e)},Hn=t=>{const r=Te()-t.mostRecentUpdate;t.mostRecentUpdate=Te(),t.remainingLag+=r;let n=0;for(;t.remainingLag>=_t;)if(jn(t),n++,t.remainingLag-=_t,n>100){K(t,"debug","Lag recovery spinout");break}n>1&&K(t,"debug",`Updated ${n} times to recover from lag`);const a=t.remainingLag/_t;Wn(t,a)},Gn=(t,e,r)=>{e&&(t.round={state:"over",reason:r})},Dt=(t,e,r,n)=>{const a=Ve(t,e);let s="no memo";switch(n.type){case"attack":s=`damaged by ${Ve(t,n.from).debug}'s ${n.with}`;break;case"self":s="self-damaged";break;default:throw new Error("Unknown attack type")}const o=Ln(t,e,"shield");if(o&&o.blockedAt!==null&&o.blockedAt+o.blockDuration>=Te()){K(t,"debug",`${a.debug} almost '${r}' damage, ${s}, but BLOCKED IT!`),o.blockedAt=null;return}const c=Z(t,e,"health");c.value=se(c.value-r,c.min,c.max),K(t,"debug",`${a.debug} took '${r}' damage, ${s}`),Gn(t,c.value<=0,`${a.debug}'s health depleted`)},jn=t=>{for(;t.inputChanges.length>0;){const e=t.inputChanges.shift(),r=Z(t,e.entityId,e.type);if(!r)throw new Error;if(r.parentType==="sliderInput")r.value=se(e.value,r.min,r.max);else if(r.type==="targeter")r.targetEntityId=e.value;else if(r.type==="sword")r.swinging=!0;else if(r.type==="shield")r.blocking=!0;else throw new Error(`Unhandled input type '${e.type}'`);K(t,"debug",`Updated ${e.type} to value ${e.value}`)}t.round.state==="occurring"&&t.components.forEach(e=>{switch(e.parentType){case"resource":{switch(e.type){case"autopistol":{if(e.value<e.costPerShot)break;e.value=e.value-e.costPerShot;const r=Z(t,e.entityId,"targeter");if(r.targetEntityId===null)break;Dt(t,r.targetEntityId,e.powerPerShot,{type:"attack",from:e.entityId,with:e.type})}break;case"hackingModule":{if(Z(t,e.entityId,"hackingToggle").value===0)break;const n=Z(t,e.entityId,"battery");if(n.value<e.chargeCost||(n.value=se(n.value-e.chargeCost,n.min,n.max),e.value=se(e.value+e.progressPerCharge,e.min,e.max),e.value<e.max))break;e.value=e.min;let a=!1;const s=Z(t,e.entityId,"targeter");if(s.targetEntityId===null)break;if(e.phase==="attempting to disable")if(e.targetedComponentType===null)K(t,"debug","hacking module target was null when attempting to disable"),e.phase="scanning components";else{const o=Z(t,s.targetEntityId,e.targetedComponentType);if(!o)K(t,"debug","hacking module target was unavailable when attempting to disable"),e.phase="scanning components";else{const c=Math.random()>e.successChance;switch(o.parentType){case"sliderInput":case"resource":if(c){const u=o.max-o.min,w=o.value;o.value=se(o.value-Math.ceil(u/e.resourceLossRatio),o.min,o.max);const y=o.value;K(t,"debug",`Successfully hacked (${w}->${y}) module type '${o.type}'`)}else K(t,"debug",`Failed to hack module type '${o.type}'`);e.phase="scanning components",e.targetedComponentType=null,a=!0;break;default:K(t,"debug",`hacking module target type '${o.type}' unhackable`),e.phase="scanning components",e.targetedComponentType=null;break}}}if(e.phase==="scanning components"&&!a){const o=t.components.filter(u=>u.entityId===s.targetEntityId&&(u.parentType==="resource"||u.parentType==="sliderInput"));e.targetedComponentType=Rn(o).type;const c=Ve(t,s.targetEntityId);e.phase="attempting to disable",K(t,"debug",`hacking module targeted ${c.debug}'s '${e.targetedComponentType}'`),a=!0}a||K(t,"debug","hacking module did nothing")}break}e.value=se(e.value+e.velocity,e.min,e.max)}break;case"sliderInput":switch(e.type){case"taser":{if(e.value<=0)break;const a=Z(t,e.entityId,"battery"),s=a.value;if(a.value==null)break;a.value=se(a.value-e.batteryCostRatio*e.value,a.min,a.max);const o=s-a.value,c=Z(t,e.entityId,"targeter");if(c.targetEntityId===null)break;Dt(t,c.targetEntityId,o**e.damageScaleExponent,{type:"attack",from:e.entityId,with:e.type})}break;case"generator":const r=Z(t,e.entityId,"fuel"),n=Z(t,e.entityId,"battery");for(let a=0;a<e.value;a++){if(r.value<e.fuelCost)return;r.value=se(r.value-e.fuelCost,r.min,r.max),n.value=se(n.value+e.batteryGenerationAmount*(a+1)**e.chargeExponent,n.min,n.max)}break}break;case"unique":switch(e.type){case"sword":{const r=e.swinging;if(e.swinging=!1,e.value=se(e.value+e.velocity,e.min,e.max),e.ready=!0,e.value<e.max){r&&K(t,"debug","Swing attempted before sword was ready"),e.ready=!1;break}const n=Z(t,e.entityId,"fuel");if(n.value<e.costPerSwing){r&&K(t,"debug","Swing attempted before fuel cost satisfied"),e.ready=!1;break}const a=Z(t,e.entityId,"targeter");if(a.targetEntityId===null){r&&K(t,"debug","Swing attempted but no target"),e.ready=!1;break}if(!r)break;n.value-=e.costPerSwing,e.value=e.min,Dt(t,a.targetEntityId,e.baseDamage,{type:"attack",from:e.entityId,with:e.type})}break;case"shield":{if(e.value=se(e.value+e.velocity,e.min,e.max),!e.blocking)break;if(e.blocking=!1,e.value<e.max){K(t,"debug","Block attempted before shield was ready");break}const r=Z(t,e.entityId,"fuel");if(r.value<e.costPer){K(t,"debug","Block attempted before fuel cost satisfied");break}if(e.numUses<=0){K(t,"debug","Block attempted but no remaining uses");break}r.value-=e.costPer,e.value=e.min,e.numUses--,e.blockedAt=Te()}break}}})},Wn=(t,e)=>{t.optimistic={...t.components},Object.entries(t.optimistic).forEach(([r,n])=>{const{parentType:a}=n;switch(a){case"resource":n.value=se(n.value+n.velocity*e,n.min,n.max);break}})};var Kn=F('<meter style="will-change: contents;width: 2em;"> </meter>');function Ue(t,e){const r=I(()=>e.component.min),n=I(()=>e.component.max),a=I(()=>e.component.value);let s=I(()=>i(n)-i(r));var o=Kn(),c=d(o);l(o),z(()=>{g(o,"min",i(r)),g(o,"low",i(s)/2.5+i(r)),g(o,"high",i(s)*99/100+i(r)),g(o,"optimum",i(s)*99.9/100+i(r)),g(o,"max",i(n)),En(o,i(a)),A(c,`${i(a)??""} of ${i(n)??""}`)}),h(t,o)}var Yn=F('<div style="padding: 1em; border: 2px outset;"><!></div>');function Qe(t,e){kt(e,!0);const r=I(()=>Z(e.game,e.entityId,e.type));var n=Yn(),a=d(n);Tr(a,()=>e.render,()=>i(r),()=>e.entityId,()=>e.type),l(n),h(t,n),Pt()}var Xn=Yt("<rect></rect>"),Zn=Yt('<rect style="fill: var(--color-fg);"></rect><text text-anchor="end" font-size="0.6em" style="fill: var(--color-fg); pointer-events:none;"> </text>',1),Qn=Yt('<svg style="height: calc(100% - 1px); width: 100%;" tabindex="0" role="switch"><rect style="fill: #ffffffaa;"></rect><rect style="fill: rgba(0, 0, 0, 0.8);"></rect><g><!><!></g><rect style="fill: #ffffffaa;"></rect><rect style="fill: #ff674baa;"></rect></svg>');function Jn(t,e){kt(e,!0);let r=Me(0),n=Me(0),a=I(()=>({view:{xMin:0,yMin:0,xMax:i(n),yMax:i(r)}})),s=I(()=>i(a).view.xMax-i(a).view.xMin),o=I(()=>i(a).view.yMax-i(a).view.yMin),c=I(()=>e.game.mostRecentUpdate*.2);const u=10;let w=Ut(Array(u).fill(null)),y=I(()=>w),U=I(()=>i(c)-Math.floor(i(c)/1e3)*1e3),B=I(()=>i(o)/u),p=I(()=>k=>i(B)*k+i(B)/1e3*i(U)),v=I(()=>k=>{const E=k.target.getAttribute("data-index");if(!E)return;const D=Number(E);w[D]=!0}),b=I(()=>k=>{const E=k.target.getAttribute("data-index");if(!E)return;const D=Number(E);w[D]=!1});var $=Qn();z(()=>g($,"viewBox",[i(a).view.xMin,i(a).view.yMin,i(a).view.xMax,i(a).view.yMax].join(" "))),$.__mouseover=function(...k){var E;(E=i(v))==null||E.apply(this,k)},$.__mouseout=function(...k){var E;(E=i(b))==null||E.apply(this,k)};var M=d($);g(M,"y",0),g(M,"height",1);var R=f(M);z(()=>g(R,"y",i(p)(-1)));var q=f(R),ee=d(q);lt(ee,17,()=>i(y),st,(k,E,D)=>{var O=Xn();g(O,"data-index",D),z(()=>g(O,"y",i(p)(D))),z(()=>{g(O,"x",i(a).view.xMin),g(O,"width",i(s)),g(O,"height",i(B)),g(O,"style",`fill: ${(i(E)?"rgba(0, 0, 0, 0.1)":"rgba(0, 0, 0, 0.8)")??""}; cursor:pointer;`)}),h(k,O)});var x=f(ee);lt(x,17,()=>i(y),st,(k,E,D)=>{var O=Zn();const G=I(()=>Math.floor(i(c)/1e3)-(D-u/2)),le=I(()=>i(G)%2===0?i(s)/4:i(s)/8);var ue=W(O);z(()=>g(ue,"y",i(p)(D))),g(ue,"height",1);var de=f(ue);z(()=>g(de,"y",i(p)(D)+3));var Y=d(de,!0);l(de),z(()=>{g(ue,"x",i(a).view.xMin),g(ue,"width",i(le)),g(de,"x",i(s)-10),A(Y,i(G))}),h(k,O)}),l(q);var m=f(q);g(m,"height",1);var H=f(m);g(H,"height",1),l($),z(()=>{g(M,"x",i(a).view.xMin),g(M,"width",i(s)),g(R,"x",i(a).view.xMin),g(R,"width",i(s)),g(R,"height",i(B)),g(m,"x",i(a).view.xMin),g(m,"width",i(s)),g(m,"y",i(o)-1),g(H,"x",i(a).view.xMin),g(H,"width",i(s)),g(H,"y",i(o)/2)}),mr($,"clientHeight",k=>S(r,k)),mr($,"clientWidth",k=>S(n,k)),h(t,$),Pt()}Qt(["mouseover","mouseout"]);var $r=Symbol.for("immer-nothing"),br=Symbol.for("immer-draftable"),_e=Symbol.for("immer-state");function ze(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var et=Object.getPrototypeOf;function tt(t){return!!t&&!!t[_e]}function Ke(t){var e;return t?Nr(t)||Array.isArray(t)||!!t[br]||!!((e=t.constructor)!=null&&e[br])||Et(t)||zt(t):!1}var Vn=Object.prototype.constructor.toString();function Nr(t){if(!t||typeof t!="object")return!1;const e=et(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Vn}function mt(t,e){It(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function It(t){const e=t[_e];return e?e.type_:Array.isArray(t)?1:Et(t)?2:zt(t)?3:0}function qt(t,e){return It(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Lr(t,e,r){const n=It(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function ea(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Et(t){return t instanceof Map}function zt(t){return t instanceof Set}function We(t){return t.copy_||t.base_}function Ht(t,e){if(Et(t))return new Map(t);if(zt(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Nr(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[_e];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],c=n[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[o]})}return Object.create(et(t),n)}else{const n=et(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function Jt(t,e=!1){return Ct(t)||tt(t)||!Ke(t)||(It(t)>1&&(t.set=t.add=t.clear=t.delete=ta),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Jt(n,!0))),t}function ta(){ze(2)}function Ct(t){return Object.isFrozen(t)}var ra={};function Ye(t){const e=ra[t];return e||ze(0,t),e}var ut;function Ur(){return ut}function na(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function xr(t,e){e&&(Ye("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Gt(t){jt(t),t.drafts_.forEach(aa),t.drafts_=null}function jt(t){t===ut&&(ut=t.parent_)}function wr(t){return ut=na(ut,t)}function aa(t){const e=t[_e];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function kr(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[_e].modified_&&(Gt(e),ze(4)),Ke(t)&&(t=ht(e,t),e.parent_||bt(e,t)),e.patches_&&Ye("Patches").generateReplacementPatches_(r[_e].base_,t,e.patches_,e.inversePatches_)):t=ht(e,r,[]),Gt(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==$r?t:void 0}function ht(t,e,r){if(Ct(e))return e;const n=e[_e];if(!n)return mt(e,(a,s)=>Pr(t,n,e,a,s,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return bt(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let s=a,o=!1;n.type_===3&&(s=new Set(a),a.clear(),o=!0),mt(s,(c,u)=>Pr(t,n,a,c,u,r,o)),bt(t,a,!1),r&&t.patches_&&Ye("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Pr(t,e,r,n,a,s,o){if(tt(a)){const c=s&&e&&e.type_!==3&&!qt(e.assigned_,n)?s.concat(n):void 0,u=ht(t,a,c);if(Lr(r,n,u),tt(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Ke(a)&&!Ct(a)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ht(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&bt(t,a)}}function bt(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Jt(e,r)}function ia(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Ur(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=Vt;r&&(a=[n],s=dt);const{revoke:o,proxy:c}=Proxy.revocable(a,s);return n.draft_=c,n.revoke_=o,c}var Vt={get(t,e){if(e===_e)return t;const r=We(t);if(!qt(r,e))return oa(t,r,e);const n=r[e];return t.finalized_||!Ke(n)?n:n===$t(t.base_,e)?(Nt(t),t.copy_[e]=Kt(n,t)):n},has(t,e){return e in We(t)},ownKeys(t){return Reflect.ownKeys(We(t))},set(t,e,r){const n=Br(We(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=$t(We(t),e),s=a==null?void 0:a[_e];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(ea(r,a)&&(r!==void 0||qt(t.base_,e)))return!0;Nt(t),Wt(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return $t(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Nt(t),Wt(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=We(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){ze(11)},getPrototypeOf(t){return et(t.base_)},setPrototypeOf(){ze(12)}},dt={};mt(Vt,(t,e)=>{dt[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});dt.deleteProperty=function(t,e){return dt.set.call(this,t,e,void 0)};dt.set=function(t,e,r){return Vt.set.call(this,t[0],e,r,t[0])};function $t(t,e){const r=t[_e];return(r?We(r):t)[e]}function oa(t,e,r){var a;const n=Br(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Br(t,e){if(!(e in t))return;let r=et(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=et(r)}}function Wt(t){t.modified_||(t.modified_=!0,t.parent_&&Wt(t.parent_))}function Nt(t){t.copy_||(t.copy_=Ht(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var sa=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(u=s,...w){return o.produce(u,y=>r.call(this,y,...w))}}typeof r!="function"&&ze(6),n!==void 0&&typeof n!="function"&&ze(7);let a;if(Ke(e)){const s=wr(this),o=Kt(e,void 0);let c=!0;try{a=r(o),c=!1}finally{c?Gt(s):jt(s)}return xr(s,n),kr(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===$r&&(a=void 0),this.autoFreeze_&&Jt(a,!0),n){const s=[],o=[];Ye("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else ze(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...c)=>this.produceWithPatches(o,u=>e(u,...c));let n,a;return[this.produce(e,r,(o,c)=>{n=o,a=c}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Ke(t)||ze(8),tt(t)&&(t=la(t));const e=wr(this),r=Kt(t,void 0);return r[_e].isManual_=!0,jt(e),r}finishDraft(t,e){const r=t&&t[_e];(!r||!r.isManual_)&&ze(9);const{scope_:n}=r;return xr(n,e),kr(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=Ye("Patches").applyPatches_;return tt(t)?n(t,e):this.produce(t,a=>n(a,e))}};function Kt(t,e){const r=Et(t)?Ye("MapSet").proxyMap_(t,e):zt(t)?Ye("MapSet").proxySet_(t,e):ia(t,e);return(e?e.scope_:Ur()).drafts_.push(r),r}function la(t){return tt(t)||ze(10,t),qr(t)}function qr(t){if(!Ke(t)||Ct(t))return t;const e=t[_e];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ht(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Ht(t,!0);return mt(r,(n,a)=>{Lr(r,n,qr(a))}),e&&(e.finalized_=!1),r}var ge=new sa,gt=ge.produce;ge.produceWithPatches.bind(ge);ge.setAutoFreeze.bind(ge);ge.setUseStrictShallowCopy.bind(ge);ge.applyPatches.bind(ge);ge.createDraft.bind(ge);ge.finishDraft.bind(ge);const ua=(t,e,r)=>{S(e,"inventory"),S(r,!1)},da=(t,e,r)=>{S(e,"store"),S(r,!1)},ca=(t,e,r,n)=>{S(e,Rr(r)),S(n,!0)},Ir=(t,e,r)=>{S(e,"play"),S(r,!0)},Lt=(t,e,r)=>{S(e,"entry"),S(r,!1)},Er=(t,e)=>{S(e,gt(i(e),r=>{$n(r)}))};var fa=F('<a href="?"> </a>'),va=F("<div><!></div>"),pa=F(`<div style="display: flex; flex-direction: column; justify-content: start;
        align-items: flex-start; padding-bottom: 4em; gap:2em;"><div><h1 class="svelte-1tzfz4t">Pilots</h1> <h2 class="svelte-1tzfz4t">A game about ...?</h2></div> <div><a href="?">Cockpit</a></div> <div><a href="?">Shop</a></div> <div><a href="?">Inventory</a></div> <!> <div><a href="/design">Design notes</a></div></div>`),ya=F('<p><a href="?">Begin</a></p>'),_a=F('<p>Paused. <a href="?">Unpause</a></p>'),ga=F('<div style="will-change: contents"> <!></div>'),ma=F('<div style="display: grid; grid-template-columns: 1fr 1fr; justify-items: flex-end;"><div>Auto Pistol Cooldown</div> <svg style="height: 3em;"><circle style="fill: var(--color-fg)"></circle><circle style="fill: var(--color-bg)"></circle></svg></div>'),ha=F('<div>Health</div> <div style="will-change: contents"> <!></div>',1),ba=F('<div style="will-change: contents"> <!></div>'),xa=F(`<div style="width: 100%; height: 100%; display: grid;
                                 grid-template-columns: min-content min-content;
                                 justify-content: space-between; grid-template-rows:
                                 max-content;"><div><div>Sword</div> <label style="display: flex; flex-direction: row; justify-content: space-between; gap: 0.4em">Cooldown <!></label> <label style="display: flex; flex-direction: row; justify-content: space-between; gap: 0.4em">Fuel cost <!></label></div> <button>Swing</button></div>`),wa=F(`<div style="width: 100%; height: 100%; display: grid;
                                 grid-template-columns: min-content min-content;
                                 justify-content: space-between; grid-template-rows:
                                 max-content;"><div><div>Shield</div> <label style="display: flex; flex-direction: row; justify-content: space-between; gap: 0.4em">Cooldown <!></label> <label style="display: flex; flex-direction: row; justify-content: space-between; gap: 0.4em">Fuel cost <!></label> <label style="display: flex; flex-direction: row; justify-content: space-between; gap: 0.4em"> <!></label></div> <button style="border-radius: 9999px; border: 4px inset lightsteelblue; background-color: lightsteelblue; padding: 1em; display: block; aspect-ratio:1;">Block</button></div>`),ka=F('<!> <div style="display: grid; grid-template-columns: minmax(50px, 10vw) 1fr"><!> <div style="display:grid; grid-template-rows: max-content max-content;"><div style=""><div style="box-sizing: border-box;  border:4px inset; border-radius: 1.9em;"><div style="box-sizing: border-box;  border:4px inset; border-radius: 1.9em;"><div style="box-sizing: border-box;  border:4px inset; border-radius: 1.9em;"><div style="border:4px inset; border-radius: 1.9em; padding: 0.4em;"><h2 class="svelte-1tzfz4t">Enemy</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;"><!> <!></div></div></div></div></div></div> <div style="width:100%; overflow-y: auto;"><h2 class="svelte-1tzfz4t">Player</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;"><!> <!> <!> <!></div></div></div></div>',1),Pa=F('<h2 class="svelte-1tzfz4t">Game over</h2> <p> </p>',1),Ia=F('<div style="display:grid; grid-template-rows: 1fr; grid-template-columns: 1fr;"><!></div> <nav class="svelte-1tzfz4t"><a href="?">Restart</a> <a href="?">Back To Title</a> <!> <a href="?"> </a></nav>',1),Ea=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),za=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),Ca=F(`<h2 class="svelte-1tzfz4t"> </h2> <p style="padding-inline: 4em">This is your inventory where you can see your current parts. You can also rearrange your
        parts to maximize their effectiveness</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <h2 class="svelte-1tzfz4t"> </h2> <p style="padding-inline: 4em">This is your enemy's inventory. Do you see what you're up against?</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav class="svelte-1tzfz4t"><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a> <!></nav>`,1),Sa=(t,e,r)=>e(i(r)),Ma=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div> <button>Sell</button></div>'),Ta=F('<h2 class="svelte-1tzfz4t">The Shop</h2> <p style="padding-inline: 4em">Buy more stuff here.</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav class="svelte-1tzfz4t"><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a> <!></nav>',1),Aa=F(`<main style="height: 100%; display: grid; grid-template-rows: 1fr max-content;
    justify-items: center; align-items: stretch; box-sizing: border-box; "><!></main>`);function Ua(t,e){kt(e,!0);const r=(p,v=Ee,b=Ee,$=Ee)=>{var M=Aa();const R=m=>{var H=fa();H.__click=function(...E){var D;(D=$())==null||D.apply(this,E)};var k=d(H,!0);l(H),z(()=>A(k,b()?"Exit Fullscreen":"Fullscreen")),h(m,H)};var q=d(M);{var ee=m=>{var H=pa(),k=f(d(H),2),E=d(k);E.__click=U,l(k);var D=f(k,2),O=d(D);O.__click=[da,y,w],l(D);var G=f(D,2),le=d(G);le.__click=[ua,y,w],l(G);var ue=f(G,2);{var de=Y=>{var te=va(),ce=d(te);R(ce),l(te),h(Y,te)};L(ue,Y=>{v()&&Y(de)})}bn(2),l(H),h(m,H)},x=m=>{var H=Ie(),k=W(H);{var E=O=>{var G=Ia(),le=W(G),ue=d(le);{var de=Q=>{var me=ya(),Ne=d(me);Ne.__click=U,l(me),h(Q,me)},Y=Q=>{var me=Ie(),Ne=W(me);{var rt=T=>{var N=ka(),J=W(N);{var re=Re=>{var ne=_a(),_=f(d(ne));_.__click=[Er,u],l(ne),h(Re,ne)};L(J,Re=>{i(u).round.state==="paused"&&Re(re)})}var V=f(J,2),he=d(V);Jn(he,{get game(){return i(u)}});var fe=f(he,2),oe=d(fe),ve=d(oe),be=d(ve),xe=d(be),Le=d(xe),er=f(d(Le),2),tr=d(er);Qe(tr,{get game(){return i(u)},entityId:c,type:"health",render:(ne,_=Ee)=>{var ae=Ie(),pe=W(ae);{var ie=C=>{},ke=C=>{var j=ga(),P=d(j);z(()=>A(P,`Health ${_().formatter(_().value)??""}/${_().max??""} `));var X=f(P);Ue(X,{get component(){return _()}}),l(j),h(C,j)};L(pe,C=>{_()?C(ke,!1):C(ie)})}h(ne,ae)},$$slots:{render:!0}});var Hr=f(tr,2);Qe(Hr,{get game(){return i(u)},entityId:c,type:"autopistol",render:(ne,_=Ee)=>{var ae=Ie(),pe=W(ae);{var ie=C=>{},ke=C=>{var j=ma();const P=I(()=>({view:{xMin:0,yMin:0,xMax:100,yMax:100}})),X=I(()=>(i(P).view.xMax-i(P).view.xMin)/2),ye=I(()=>(i(P).view.yMax-i(P).view.yMin)/2),Se=I(()=>i(ye)+i(P).view.xMin);var Ge=f(d(j),2);z(()=>g(Ge,"viewBox",[i(P).view.xMin,i(P).view.yMin,i(P).view.xMax,i(P).view.yMax].join(" ")));var Pe=d(Ge),je=f(Pe);l(Ge),l(j),z(()=>{g(Pe,"cx",i(X)),g(Pe,"cy",i(ye)),g(Pe,"r",i(Se)),g(je,"cx",i(X)),g(je,"cy",i(ye)),g(je,"r",_().value/_().max*i(Se))}),h(C,j)};L(pe,C=>{_()?C(ke,!1):C(ie)})}h(ne,ae)},$$slots:{render:!0}}),l(er),l(Le),l(xe),l(be),l(ve),l(oe);var rr=f(oe,2),nr=f(d(rr),2),ar=d(nr);Qe(ar,{get game(){return i(u)},entityId:o,type:"health",render:(ne,_=Ee)=>{var ae=Ie(),pe=W(ae);{var ie=C=>{},ke=C=>{var j=ha(),P=f(W(j),2),X=d(P);z(()=>A(X,`${_().formatter(_().value)??""}/${_().max??""} `));var ye=f(X);Ue(ye,{get component(){return _()}}),l(P),h(C,j)};L(pe,C=>{_()?C(ke,!1):C(ie)})}h(ne,ae)},$$slots:{render:!0}});var ir=f(ar,2);Qe(ir,{get game(){return i(u)},entityId:o,type:"fuel",render:(ne,_=Ee)=>{var ae=Ie(),pe=W(ae);{var ie=C=>{},ke=C=>{var j=ba(),P=d(j);z(()=>A(P,`Fuel ${_().formatter(_().value)??""}/${_().max??""} `));var X=f(P);Ue(X,{get component(){return _()}}),l(j),h(C,j)};L(pe,C=>{_()?C(ke,!1):C(ie)})}h(ne,ae)},$$slots:{render:!0}});var or=f(ir,2);Qe(or,{get game(){return i(u)},entityId:o,type:"sword",render:(ne,_=Ee,ae=Ee)=>{var pe=Ie();const ie=I(()=>Z(i(u),ae(),"fuel"));var ke=W(pe);{var C=P=>{},j=P=>{var X=xa(),ye=d(X),Se=f(d(ye),2),Ge=f(d(Se));Ue(Ge,{get component(){return _()}}),l(Se);var Pe=f(Se,2),je=f(d(Pe)),St=I(()=>({min:i(ie).min,max:_().costPerSwing,value:se(i(ie).value,i(ie).min,_().costPerSwing)}));Ue(je,{get component(){return i(St)}}),l(Pe),l(ye);var Xe=f(ye,2),ft=I(()=>n(_().type));Xe.__click=function(...Mt){var vt;(vt=i(ft))==null||vt.apply(this,Mt)},l(X),z(()=>{Xe.disabled=_().swinging,g(Xe,"style",`border-radius: 9999px; border: 4px inset tomato; background-color: ${(_().ready?"tomato":"darkorange")??""}; padding: 1em; display: block; aspect-ratio:1;`)}),h(P,X)};L(ke,P=>{_()?P(j,!1):P(C)})}h(ne,pe)},$$slots:{render:!0}});var Gr=f(or,2);Qe(Gr,{get game(){return i(u)},entityId:o,type:"shield",render:(ne,_=Ee,ae=Ee)=>{var pe=Ie();const ie=I(()=>Z(i(u),ae(),"fuel"));var ke=W(pe);{var C=P=>{},j=P=>{var X=wa(),ye=d(X),Se=f(d(ye),2),Ge=f(d(Se));Ue(Ge,{get component(){return _()}}),l(Se);var Pe=f(Se,2),je=f(d(Pe)),St=I(()=>({min:i(ie).min,max:_().costPer,value:se(i(ie).value,i(ie).min,_().costPer)}));Ue(je,{get component(){return i(St)}}),l(Pe);var Xe=f(Pe,2),ft=d(Xe),Mt=f(ft),vt=I(()=>({min:0,max:_().totalUses,value:_().numUses}));Ue(Mt,{get component(){return i(vt)}}),l(Xe),l(ye);var sr=f(ye,2),jr=I(()=>n(_().type));sr.__click=function(...Wr){var lr;(lr=i(jr))==null||lr.apply(this,Wr)},l(X),z(()=>{A(ft,`${_().numUses??""}/${_().totalUses??""} `),sr.disabled=_().blocking}),h(P,X)};L(ke,P=>{_()?P(j,!1):P(C)})}h(ne,pe)},$$slots:{render:!0}}),l(nr),l(rr),l(fe),l(V),h(T,N)},we=T=>{var N=Ie(),J=W(N);{var re=V=>{var he=Pa(),fe=f(W(he),2),oe=d(fe);l(fe),z(()=>A(oe,`Reason: ${i(u).round.reason??""}`)),h(V,he)};L(J,V=>{i(u).round.state==="over"&&V(re)},!0)}h(T,N)};L(Ne,T=>{i(u).round.state==="occurring"||i(u).round.state==="paused"?T(rt):T(we,!1)},!0)}h(Q,me)};L(ue,Q=>{i(u).round.state==="not yet started"?Q(de):Q(Y,!1)})}l(le);var te=f(le,2),ce=d(te);ce.__click=[ca,u,s,w];var Ae=f(ce,2);Ae.__click=[Lt,y,w];var Ce=f(Ae,2);{var De=Q=>{R(Q)};L(Ce,Q=>{v()&&Q(De)})}var Fe=f(Ce,2);Fe.__click=[Er,u];var $e=d(Fe,!0);l(Fe),l(te),z(()=>A($e,i(B)?"Unpause (Paused)":"Pause")),h(O,G)},D=O=>{var G=Ie(),le=W(G);{var ue=Y=>{var te=Ca(),ce=W(te),Ae=d(ce);z(()=>A(Ae,`${Ve(i(u),o).debug??""}'s Inventory`)),l(ce);var Ce=f(ce,4);lt(Ce,21,()=>i(u).parts.filter(({entityId:T})=>T===o),st,(T,N)=>{var J=Ea(),re=d(J),V=d(re),he=d(V,!0);l(V);var fe=f(V,2),oe=d(fe,!0);l(fe),l(re);var ve=f(re,2);Ze(ve,"font-size","0.8em");var be=d(ve),xe=f(be);Ze(xe,"font-size","0.8em");var Le=d(xe,!0);z(()=>A(Le,i(N).components.join(" "))),l(xe),l(ve),l(J),z(()=>{A(he,i(N).title),A(oe,i(N).description),A(be,`${i(N).type??""} `)}),h(T,J)}),l(Ce);var De=f(Ce,2),Fe=d(De);z(()=>A(Fe,`${Ve(i(u),c).debug??""}'s Inventory`)),l(De);var $e=f(De,4);lt($e,21,()=>i(u).parts.filter(({entityId:T})=>T===c),st,(T,N)=>{var J=za(),re=d(J),V=d(re),he=d(V,!0);l(V);var fe=f(V,2),oe=d(fe,!0);l(fe),l(re);var ve=f(re,2);Ze(ve,"font-size","0.8em");var be=d(ve),xe=f(be);Ze(xe,"font-size","0.8em");var Le=d(xe,!0);z(()=>A(Le,i(N).components.join(" "))),l(xe),l(ve),l(J),z(()=>{A(he,i(N).title),A(oe,i(N).description),A(be,`${i(N).type??""} `)}),h(T,J)}),l($e);var Q=f($e,2),me=d(Q);me.__click=[Ir,y,w];var Ne=f(me,2);Ne.__click=[Lt,y,w];var rt=f(Ne,2);{var we=T=>{R(T)};L(rt,T=>{v()&&T(we)})}l(Q),h(Y,te)},de=Y=>{var te=Ie(),ce=W(te);{var Ae=Ce=>{var De=Ta(),Fe=f(W(De),4);lt(Fe,21,()=>i(u).parts.filter(({entityId:we})=>we===o),st,(we,T)=>{var N=Ma(),J=d(N),re=d(J),V=d(re,!0);l(re);var he=f(re,2),fe=d(he,!0);l(he),l(J);var oe=f(J,2);Ze(oe,"font-size","0.8em");var ve=d(oe),be=f(ve);Ze(be,"font-size","0.8em");var xe=d(be,!0);z(()=>A(xe,i(T).components.join(" "))),l(be),l(oe);var Le=f(oe,2);Le.__click=[Sa,a,T],l(N),z(()=>{A(V,i(T).title),A(fe,i(T).description),A(ve,`${i(T).type??""} `)}),h(we,N)}),l(Fe);var $e=f(Fe,2),Q=d($e);Q.__click=[Ir,y,w];var me=f(Q,2);me.__click=[Lt,y,w];var Ne=f(me,2);{var rt=we=>{R(we)};L(Ne,we=>{v()&&we(rt)})}l($e),h(Ce,De)};L(ce,Ce=>{i(y)==="store"&&Ce(Ae)},!0)}h(Y,te)};L(le,Y=>{i(y)==="inventory"?Y(ue):Y(de,!1)},!0)}h(O,G)};L(k,O=>{i(y)==="play"?O(E):O(D,!1)},!0)}h(m,H)};L(q,m=>{i(y)==="entry"?m(ee):m(x,!1)})}l(M),h(p,M)},n=p=>v=>{S(u,gt(i(u),b=>{Ot(b,{entityId:o,type:p,value:"buttonPressed",time:Te()})}))},a=p=>{S(u,gt(i(u),v=>{Bn(v,p.entityId,p.type)}))},s=Nn(),o=hr(s,"Player");ot(s,o,"core"),ot(s,o,"sword"),ot(s,o,"shield");const c=hr(s,"Enemy");ot(s,c,"core"),ot(s,c,"autopistol"),Ot(s,{entityId:o,type:"targeter",value:c,time:Te()}),Ot(s,{entityId:c,type:"targeter",value:o,time:Te()});let u=Me(s),w=Me(!1);hn(()=>{let p=!1;const v=()=>{i(w)&&S(u,gt(i(u),b=>{Hn(b)})),p||requestAnimationFrame(v)};return requestAnimationFrame(v),()=>{p=!0}});let y=Me("entry");const U=()=>{S(y,"play"),S(u,Rr(s)),S(w,!0)};U();const B=I(()=>i(u).round.state==="paused");An(t,{fullscreenable:r}),Pt()}Qt(["click"]);export{Ua as component};
