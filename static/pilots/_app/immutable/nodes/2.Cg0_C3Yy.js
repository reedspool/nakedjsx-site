import{a as h,t as F,c as ve}from"../chunks/disclose-version.CLXa-AFD.js";import{h as xe,C as it,Q as nr,a0 as ar,A as or,b as ir,z as sr,_ as Ut,H as lr,B as Pt,D as st,c as qe,W as ur,as as Ye,F as Bt,a as qt,G as cr,w as Et,at as dr,au as fr,Z as vr,av as pr,d as _r,O as mr,an as yr,s as Ct,aw as gr,ax as hr,ay as br,T as kr,az as wr,y as xr,aA as Pr,p as $t,a6 as L,i as jt,r as T,v as o,ar as Ee,a7 as d,a9 as u,a8 as c,a5 as U,u as Er,n as Ze,e as Cr,g as q}from"../chunks/runtime.Bm73Tpmf.js";import{d as Gt,s as M}from"../chunks/render.BfQ3xYTj.js";import{i as N,b as Ir,p as It}from"../chunks/this.CnBV6IW7.js";import{s as Ht}from"../chunks/snippet.Cwy7Ud8A.js";import{o as Sr}from"../chunks/index-client.B3YRV3HL.js";function lt(e,t){return t}function Tr(e,t,r,n){for(var a=[],s=t.length,i=0;i<s;i++)fr(t[i].e,a,!0);var v=s>0&&a.length===0&&r!==null;if(v){var y=r.parentNode;vr(y),y.append(r),n.clear(),Pe(e,t[0].prev,t[s-1].next)}pr(a,()=>{for(var E=0;E<s;E++){var z=t[E];v||(n.delete(z.k),Pe(e,z.prev,z.next)),_r(z.e,!v)}})}function ut(e,t,r,n,a,s=null){var i=e,v={flags:t,items:new Map,first:null};{var y=e;i=xe?it(nr(y)):y.appendChild(ar())}xe&&or();var E=null,z=!1;ir(()=>{var p=r(),b=sr(p)?p:p==null?[]:Ut(p),g=b.length;if(z&&g===0)return;z=g===0;let l=!1;if(xe){var x=i.data===lr;x!==(g===0)&&(i=Pt(),it(i),st(!1),l=!0)}if(xe){for(var C=null,te,_=0;_<g;_++){if(qe.nodeType===8&&qe.data===ur){i=qe,l=!0,st(!1);break}var m=b[_],f=n(m,_);te=Kt(qe,v,C,null,m,f,_,a,t),v.items.set(f,te),C=te}g>0&&it(Pt())}if(!xe){var I=mr;Fr(b,v,i,a,t,(I.f&Ye)!==0,n)}s!==null&&(g===0?E?Bt(E):E=qt(()=>s(i)):E!==null&&cr(E,()=>{E=null})),l&&st(!0),r()}),xe&&(i=qe)}function Fr(e,t,r,n,a,s,i,v){var y=e.length,E=t.items,z=t.first,p=z,b,g=null,l=[],x=[],C,te,_,m;for(m=0;m<y;m+=1){if(C=e[m],te=i(C,m),_=E.get(te),_===void 0){var f=p?p.e.nodes_start:r;g=Kt(f,t,g,g===null?t.first:g.next,C,te,m,n,a),E.set(te,g),l=[],x=[],p=g.next;continue}if(zr(_,C,m),_.e.f&Ye&&Bt(_.e),_!==p){if(b!==void 0&&b.has(_)){if(l.length<x.length){var I=x[0],S;g=I.prev;var O=l[0],k=l[l.length-1];for(S=0;S<l.length;S+=1)St(l[S],I,r);for(S=0;S<x.length;S+=1)b.delete(x[S]);Pe(t,O.prev,k.next),Pe(t,g,O),Pe(t,k,I),p=I,g=k,m-=1,l=[],x=[]}else b.delete(_),St(_,p,r),Pe(t,_.prev,_.next),Pe(t,_,g===null?t.first:g.next),Pe(t,g,_),g=_;continue}for(l=[],x=[];p!==null&&p.k!==te;)(s||!(p.e.f&Ye))&&(b??(b=new Set)).add(p),x.push(p),p=p.next;if(p===null)continue;_=p}l.push(_),g=_,p=_.next}if(p!==null||b!==void 0){for(var w=b===void 0?[]:Ut(b);p!==null;)(s||!(p.e.f&Ye))&&w.push(p),p=p.next;var R=w.length;if(R>0){var P=y===0?r:null;Tr(t,w,P,E)}}Et.first=t.first&&t.first.e,Et.last=g&&g.e}function zr(e,t,r,n){dr(e.v,t),e.i=r}function Kt(e,t,r,n,a,s,i,v,y,E){var z=(y&hr)!==0,p=(y&br)===0,b=z?p?yr(a):Ct(a):a,g=y&gr?Ct(i):i,l={i:g,v:b,k:s,a:null,e:null,prev:r,next:n};try{return l.e=qt(()=>v(e,b,g),xe),l.e.prev=r&&r.e,l.e.next=n&&n.e,r===null?t.first=l:(r.next=l,r.e.next=l.e),n!==null&&(n.prev=l,n.e.prev=l.e),l}finally{}}function St(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,a=t?t.e.nodes_start:r,s=e.e.nodes_start;s!==n;){var i=kr(s);a.before(s),s=i}}function Pe(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Ar(e,t){var r=e.__attributes??(e.__attributes={});r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t)}function $e(e,t,r,n){var a=e.__attributes??(e.__attributes={});xe&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[wr]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Mr(e).includes(t)?e[t]=r:e.setAttribute(t,r))}var Tt=new Map;function Mr(e){var t=Tt.get(e.nodeName);if(t)return t;Tt.set(e.nodeName,t=[]);for(var r,n=e,a=Element.prototype;a!==n;){r=Pr(n);for(var s in r)r[s].set&&t.push(s);n=xr(n)}return t}function Rr(e,t,r){if(r){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}function Re(e,t,r,n){var a=e.__styles??(e.__styles={});a[t]!==r&&(a[t]=r,e.style.setProperty(t,r,""))}var Or=F('<button class="svelte-9gqnah"><i class="material-icons md-36 svelte-9gqnah"> </i></button>'),Dr=F('<div class="svelte-9gqnah"><!> <!></div>');function Nr(e,t){$t(t,!0);let r=Ee(!1),n=Ee(null);const a=()=>{};let s=Ee(a),i=Ee(a),v=Ee(!1);Sr(()=>{T(i,()=>{(o(n).requestFullscreen||o(n).mozRequestFullScreen||o(n).webkitRequestFullscreen||o(n).msRequestFullscreen||a).bind(o(n))()}),T(s,It((document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen||a).bind(document))),T(v,!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(x=>document.addEventListener(x,()=>{T(r,It(document.fullscreenElement)),console.log(`Fullscreen updated to ${o(r)?"ON":"OFF"}`)},!1));const l=document.createElement("link");return l.rel="stylesheet",l.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(l),()=>{l.parentNode.removeChild(l)}});const y=()=>{if(o(v)){if(o(r)&&!document.fullscreenElement){console.error("Fullscreen was out of sync"),T(r,!1);return}o(r)?o(s)():o(i)(o(n)),T(r,!o(r))}};let E=U(()=>o(r)?"fullscreen_exit":"fullscreen");var z=Dr(),p=d(z);Ht(p,()=>t.fullscreenable,()=>o(v),()=>o(r),()=>y);var b=u(p,2);{var g=l=>{var x=Or();x.__click=y;var C=d(x),te=d(C,!0);c(C),c(x),L(()=>M(te,o(E))),h(l,x)};N(b,l=>{!t.fullscreenable&&o(v)&&l(g)})}c(z),Ir(z,l=>T(n,l),()=>o(n)),L(()=>Rr(z,"isFull",o(r))),h(e,z),jt()}Gt(["click"]);const Lr=e=>Math.floor(Math.random()*e),Ur=e=>e[Lr(e.length)],W=(e,t,r)=>Math.min(r,Math.max(e,t)),ct=25,Br={core:{type:"core",components:["targeter","health"],title:"Core",description:"Processing, control, mechanical center"},bipedalLegs:{type:"bipedalLegs",components:["fuel","stance"],title:"Legs",description:"Stand, shift, and shuffle on two feet"},autopistol:{type:"autopistol",components:["autopistol","targeter"],title:"Gun",description:"Chk chk boom"},sword:{type:"sword",components:["sword","targeter","fuel"],title:"Sword",description:"Schwa-schwa-krang"},shield:{type:"shield",components:["shield","fuel"],title:"Shield",description:"A fancy name for a metal slab"},taser:{type:"taser",components:["targeter","taser","generator","battery"],title:"Taser",description:"Zzztt"},hackingModule:{type:"hackingModule",components:["targeter","hackingModule","hackingToggle","generator","battery"],title:"Taser",description:"Zzztt"}},je=()=>({parentType:"resource",min:0,max:100,value:100,velocity:0,formatter:e=>Math.trunc(e)}),We=()=>({parentType:"sliderInput",min:0,max:100,value:100,formatter:e=>Math.trunc(e)}),qr={fuel:{type:"fuel",...je(),velocity:1},battery:{type:"battery",...je(),max:1e3,value:200,velocity:-1},generator:{type:"generator",...We(),max:3,value:1,fuelCost:1,batteryGenerationAmount:1,chargeExponent:1.1},taser:{type:"taser",...We(),max:1,value:0,batteryCostRatio:16,damageScaleExponent:1e-4},health:{type:"health",...je()},autopistol:{type:"autopistol",...je(),max:3,costPerShot:3,powerPerShot:5,value:0,velocity:.01},sword:{type:"sword",parentType:"unique",costPerSwing:90,baseDamage:25,value:0,min:0,max:100,velocity:1,formatter:e=>Math.trunc(e),swinging:!1},shield:{type:"shield",parentType:"unique",costPer:90,value:0,min:0,max:100,velocity:1.6,totalUses:3,numUses:3,formatter:e=>Math.trunc(e),blocking:!1},stance:{type:"stance",...We(),min:-1,max:1,value:0},targeter:{type:"targeter",parentType:"unique",targetEntityId:null},hackingModule:{type:"hackingModule",...je(),value:0,max:100,velocity:0,progressPerCharge:1,chargeCost:16,phase:"scanning components",targetedComponentType:null,successChance:.8,resourceLossRatio:6},hackingToggle:{type:"hackingToggle",...We(),value:0,max:1}},H=(e,t,r)=>{e.log.push({timestamp:Ce(),entry:r,level:t}),console.log("Log",e.log.at(-1))},$r=e=>{const t=e.round.state;if(t!=="occurring"&&t!=="paused"){console.error("Paused when round not playing");return}e.round=t==="occurring"?{state:"paused"}:{state:"occurring"}},jr=()=>{const e=Ce();return{mostRecentUpdate:e,round:{state:"not yet started"},log:[],inputChanges:[],remainingLag:0,gameStartedTime:e,entities:[],components:[],parts:[],optimistic:[]}},Oe=(e,t,r)=>{const n=e.components.find(a=>a.entityId===t&&a.type===r);if(n)return Zt(n,r)},$=(e,t,r)=>{const n=e.components.find(a=>a.entityId===t&&a.type===r);if(!n){const a=Ne(e,t);throw new Error(`${r}' required for '${a==null?void 0:a.debug}' (${a==null?void 0:a.entityId})`)}return Zt(n,r)},Ne=(e,t)=>{let r=e.entities.find(n=>n.entityId===t);return r||(r={debug:"Unknown entity",entityId:-1}),r},Ce=()=>Math.trunc(performance.now()),Wt=e=>{const t=Ce();return{...e,round:{state:"occurring"},log:[],gameStartedTime:t,mostRecentUpdate:t}};let Gr=0;const Ft=(e,t)=>{let r=Gr++;return e.entities.push({entityId:r,debug:t}),r},Ge=(e,t,r)=>{const n=Br[r];e.parts.push({...n,entityId:t}),n.components.forEach(a=>{Yt(e,t,a)})},Hr=(e,t,r)=>{e.parts=e.parts.filter(n=>!(t===n.entityId&&r===n.type)),Kr(e,t)},Kr=(e,t)=>{e.components=e.components.filter(r=>r.entityId!==t),e.parts.filter(r=>r.entityId===t).forEach(r=>r.components.forEach(n=>{Yt(e,r.entityId,n)}))},Yt=(e,t,r)=>{{let n=qr[r];if(e.components.find(s=>s.entityId===t&&s.type==r))return;let a={...n,entityId:t};e.components.push(a)}};function Zt(e,t){if(!e)throw new Error;if(e.type!==t)throw Error(`expected tag ${t} but was ${e.type}`);return e}const dt=(e,t)=>{e.inputChanges.push(t)},Wr=e=>{const r=Ce()-e.mostRecentUpdate;e.mostRecentUpdate=Ce(),e.remainingLag+=r;let n=0;for(;e.remainingLag>=ct;)if(Yr(e),n++,e.remainingLag-=ct,n>100){H(e,"debug","Lag recovery spinout");break}n>1&&H(e,"debug",`Updated ${n} times to recover from lag`);const a=e.remainingLag/ct;Zr(e,a)},ft=(e,t,r)=>{t&&(e.round={state:"over",reason:r})},Yr=e=>{for(;e.inputChanges.length>0;){const t=e.inputChanges.shift(),r=$(e,t.entityId,t.type);if(!r)throw new Error;if(r.parentType==="sliderInput")r.value=W(t.value,r.min,r.max);else if(r.type==="targeter")r.targetEntityId=t.value;else if(r.type==="sword")r.swinging=!0;else if(r.type==="shield")r.blocking=!0;else throw new Error(`Unhandled input type '${t.type}'`);H(e,"debug",`Updated ${t.type} to value ${t.value}`)}e.round.state==="occurring"&&e.components.forEach(t=>{switch(t.parentType){case"resource":{switch(t.type){case"autopistol":{if(t.value<t.costPerShot)break;t.value=t.value-t.costPerShot;const r=$(e,t.entityId,"targeter");if(r.targetEntityId===null)break;const n=$(e,r.targetEntityId,"health");if(n.value===null)break;n.value=W(n.value-t.powerPerShot,n.min,n.max),ft(e,n.value<=0,"player lost :(")}break;case"hackingModule":{if($(e,t.entityId,"hackingToggle").value===0)break;const n=$(e,t.entityId,"battery");if(n.value<t.chargeCost||(n.value=W(n.value-t.chargeCost,n.min,n.max),t.value=W(t.value+t.progressPerCharge,t.min,t.max),t.value<t.max))break;t.value=t.min;let a=!1;const s=$(e,t.entityId,"targeter");if(s.targetEntityId===null)break;if(t.phase==="attempting to disable")if(t.targetedComponentType===null)H(e,"debug","hacking module target was null when attempting to disable"),t.phase="scanning components";else{const i=$(e,s.targetEntityId,t.targetedComponentType);if(!i)H(e,"debug","hacking module target was unavailable when attempting to disable"),t.phase="scanning components";else{const v=Math.random()>t.successChance;switch(i.parentType){case"sliderInput":case"resource":if(v){const y=i.max-i.min,E=i.value;i.value=W(i.value-Math.ceil(y/t.resourceLossRatio),i.min,i.max);const z=i.value;H(e,"debug",`Successfully hacked (${E}->${z}) module type '${i.type}'`)}else H(e,"debug",`Failed to hack module type '${i.type}'`);t.phase="scanning components",t.targetedComponentType=null,a=!0;break;default:H(e,"debug",`hacking module target type '${i.type}' unhackable`),t.phase="scanning components",t.targetedComponentType=null;break}}}if(t.phase==="scanning components"&&!a){const i=e.components.filter(y=>y.entityId===s.targetEntityId&&(y.parentType==="resource"||y.parentType==="sliderInput"));t.targetedComponentType=Ur(i).type;const v=Ne(e,s.targetEntityId);t.phase="attempting to disable",H(e,"debug",`hacking module targeted ${v.debug}'s '${t.targetedComponentType}'`),a=!0}a||H(e,"debug","hacking module did nothing")}break}t.value=W(t.value+t.velocity,t.min,t.max)}break;case"sliderInput":switch(t.type){case"taser":{if(t.value<=0)break;const a=$(e,t.entityId,"battery"),s=a.value;if(a.value==null)break;a.value=W(a.value-t.batteryCostRatio*t.value,a.min,a.max);const i=s-a.value,v=$(e,t.entityId,"targeter");if(v.targetEntityId===null)break;const y=$(e,v.targetEntityId,"health");if(y.value===null)break;y.value=W(y.value-i**t.damageScaleExponent,y.min,y.max),ft(e,y.value<=0,Ne(e,t.entityId).debug+" won!")}break;case"generator":const r=$(e,t.entityId,"fuel"),n=$(e,t.entityId,"battery");for(let a=0;a<t.value;a++){if(r.value<t.fuelCost)return;r.value=W(r.value-t.fuelCost,r.min,r.max),n.value=W(n.value+t.batteryGenerationAmount*(a+1)**t.chargeExponent,n.min,n.max)}break}break;case"unique":switch(t.type){case"sword":{if(t.value=W(t.value+t.velocity,t.min,t.max),!t.swinging)break;if(t.swinging=!1,t.value<t.max){H(e,"debug","Swing attempted before sword was ready");break}const r=$(e,t.entityId,"fuel");if(r.value<t.costPerSwing){H(e,"debug","Swing attempted before fuel cost satisfied");break}const n=$(e,t.entityId,"targeter");if(n.targetEntityId===null){H(e,"debug","Swing attempted but no target");break}r.value-=t.costPerSwing,t.value=t.min;const a=$(e,n.targetEntityId,"health");if(a.value===null)break;a.value=W(a.value-t.baseDamage,a.min,a.max),ft(e,a.value<=0,Ne(e,t.entityId).debug+" won!")}break;case"shield":{if(t.value=W(t.value+t.velocity,t.min,t.max),!t.blocking)break;if(t.blocking=!1,t.value<t.max){H(e,"debug","Block attempted before shield was ready");break}const r=$(e,t.entityId,"fuel");if(r.value<t.costPer){H(e,"debug","Block attempted before fuel cost satisfied");break}if(t.numUses<=0){H(e,"debug","Block attempted but no remaining uses");break}r.value-=t.costPer,t.value=t.min,t.numUses--,H(e,"debug","Blocked (BLOCKING NOT YET IMPLEMENTED)")}break}}})},Zr=(e,t)=>{e.optimistic={...e.components},Object.entries(e.optimistic).forEach(([r,n])=>{const{parentType:a}=n;switch(a){case"resource":n.value=W(n.value+n.velocity*t,n.min,n.max);break}})};var Xr=F('<meter style="will-change: contents;"> </meter>');function ke(e,t){const r=U(()=>t.component.min),n=U(()=>t.component.max),a=U(()=>t.component.value);let s=U(()=>o(n)-o(r));var i=Xr(),v=d(i);c(i),L(()=>{$e(i,"min",o(r)),$e(i,"low",o(s)/2.5+o(r)),$e(i,"high",o(s)*99/100+o(r)),$e(i,"optimum",o(s)*99.9/100+o(r)),$e(i,"max",o(n)),Ar(i,o(a)),M(v,`${o(a)??""} of ${o(n)??""}`)}),h(e,i)}var Xt=Symbol.for("immer-nothing"),zt=Symbol.for("immer-draftable"),ae=Symbol.for("immer-state");function pe(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Le=Object.getPrototypeOf;function Ue(e){return!!e&&!!e[ae]}function Fe(e){var t;return e?Qt(e)||Array.isArray(e)||!!e[zt]||!!((t=e.constructor)!=null&&t[zt])||tt(e)||rt(e):!1}var Qr=Object.prototype.constructor.toString();function Qt(e){if(!e||typeof e!="object")return!1;const t=Le(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Qr}function Qe(e,t){et(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function et(e){const t=e[ae];return t?t.type_:Array.isArray(e)?1:tt(e)?2:rt(e)?3:0}function mt(e,t){return et(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Jt(e,t,r){const n=et(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Jr(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function tt(e){return e instanceof Map}function rt(e){return e instanceof Set}function Te(e){return e.copy_||e.base_}function yt(e,t){if(tt(e))return new Map(e);if(rt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Qt(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ae];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const i=a[s],v=n[i];v.writable===!1&&(v.writable=!0,v.configurable=!0),(v.get||v.set)&&(n[i]={configurable:!0,writable:!0,enumerable:v.enumerable,value:e[i]})}return Object.create(Le(e),n)}else{const n=Le(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function wt(e,t=!1){return nt(e)||Ue(e)||!Fe(e)||(et(e)>1&&(e.set=e.add=e.clear=e.delete=Vr),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>wt(n,!0))),e}function Vr(){pe(2)}function nt(e){return Object.isFrozen(e)}var en={};function ze(e){const t=en[e];return t||pe(0,e),t}var He;function Vt(){return He}function tn(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function At(e,t){t&&(ze("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function gt(e){ht(e),e.drafts_.forEach(rn),e.drafts_=null}function ht(e){e===He&&(He=e.parent_)}function Mt(e){return He=tn(He,e)}function rn(e){const t=e[ae];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Rt(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ae].modified_&&(gt(t),pe(4)),Fe(e)&&(e=Je(t,e),t.parent_||Ve(t,e)),t.patches_&&ze("Patches").generateReplacementPatches_(r[ae].base_,e,t.patches_,t.inversePatches_)):e=Je(t,r,[]),gt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Xt?e:void 0}function Je(e,t,r){if(nt(t))return t;const n=t[ae];if(!n)return Qe(t,(a,s)=>Ot(e,n,t,a,s,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ve(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let s=a,i=!1;n.type_===3&&(s=new Set(a),a.clear(),i=!0),Qe(s,(v,y)=>Ot(e,n,a,v,y,r,i)),Ve(e,a,!1),r&&e.patches_&&ze("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Ot(e,t,r,n,a,s,i){if(Ue(a)){const v=s&&t&&t.type_!==3&&!mt(t.assigned_,n)?s.concat(n):void 0,y=Je(e,a,v);if(Jt(r,n,y),Ue(y))e.canAutoFreeze_=!1;else return}else i&&r.add(a);if(Fe(a)&&!nt(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Je(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ve(e,a)}}function Ve(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&wt(t,r)}function nn(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Vt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=xt;r&&(a=[n],s=Ke);const{revoke:i,proxy:v}=Proxy.revocable(a,s);return n.draft_=v,n.revoke_=i,v}var xt={get(e,t){if(t===ae)return e;const r=Te(e);if(!mt(r,t))return an(e,r,t);const n=r[t];return e.finalized_||!Fe(n)?n:n===vt(e.base_,t)?(pt(e),e.copy_[t]=kt(n,e)):n},has(e,t){return t in Te(e)},ownKeys(e){return Reflect.ownKeys(Te(e))},set(e,t,r){const n=er(Te(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=vt(Te(e),t),s=a==null?void 0:a[ae];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Jr(r,a)&&(r!==void 0||mt(e.base_,t)))return!0;pt(e),bt(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return vt(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,pt(e),bt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Te(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){pe(11)},getPrototypeOf(e){return Le(e.base_)},setPrototypeOf(){pe(12)}},Ke={};Qe(xt,(e,t)=>{Ke[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ke.deleteProperty=function(e,t){return Ke.set.call(this,e,t,void 0)};Ke.set=function(e,t,r){return xt.set.call(this,e[0],t,r,e[0])};function vt(e,t){const r=e[ae];return(r?Te(r):e)[t]}function an(e,t,r){var a;const n=er(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function er(e,t){if(!(t in e))return;let r=Le(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Le(r)}}function bt(e){e.modified_||(e.modified_=!0,e.parent_&&bt(e.parent_))}function pt(e){e.copy_||(e.copy_=yt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var on=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const i=this;return function(y=s,...E){return i.produce(y,z=>r.call(this,z,...E))}}typeof r!="function"&&pe(6),n!==void 0&&typeof n!="function"&&pe(7);let a;if(Fe(t)){const s=Mt(this),i=kt(t,void 0);let v=!0;try{a=r(i),v=!1}finally{v?gt(s):ht(s)}return At(s,n),Rt(a,s)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Xt&&(a=void 0),this.autoFreeze_&&wt(a,!0),n){const s=[],i=[];ze("Patches").generateReplacementPatches_(t,a,s,i),n(s,i)}return a}else pe(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...v)=>this.produceWithPatches(i,y=>t(y,...v));let n,a;return[this.produce(t,r,(i,v)=>{n=i,a=v}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Fe(e)||pe(8),Ue(e)&&(e=sn(e));const t=Mt(this),r=kt(e,void 0);return r[ae].isManual_=!0,ht(t),r}finishDraft(e,t){const r=e&&e[ae];(!r||!r.isManual_)&&pe(9);const{scope_:n}=r;return At(n,t),Rt(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=ze("Patches").applyPatches_;return Ue(e)?n(e,t):this.produce(e,a=>n(a,t))}};function kt(e,t){const r=tt(e)?ze("MapSet").proxyMap_(e,t):rt(e)?ze("MapSet").proxySet_(e,t):nn(e,t);return(t?t.scope_:Vt()).drafts_.push(r),r}function sn(e){return Ue(e)||pe(10,e),tr(e)}function tr(e){if(!Fe(e)||nt(e))return e;const t=e[ae];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=yt(e,t.scope_.immer_.useStrictShallowCopy_)}else r=yt(e,!0);return Qe(r,(n,a)=>{Jt(r,n,tr(a))}),t&&(t.finalized_=!1),r}var oe=new on,Xe=oe.produce;oe.produceWithPatches.bind(oe);oe.setAutoFreeze.bind(oe);oe.setUseStrictShallowCopy.bind(oe);oe.applyPatches.bind(oe);oe.createDraft.bind(oe);oe.finishDraft.bind(oe);const De=(e,t=Ze)=>{var r=yn(),n=d(r);Ht(n,t),c(r),h(e,r)},Dt=(e,t,r,n,a)=>{T(t,"play"),T(r,Wt(n)),T(a,!0)},ln=(e,t,r)=>{T(t,"inventory"),T(r,!1)},un=(e,t,r)=>{T(t,"store"),T(r,!1)},cn=(e,t,r,n)=>{T(t,Wt(r)),T(n,!0)},Nt=(e,t,r)=>{T(t,"play"),T(r,!0)},_t=(e,t,r)=>{T(t,"entry"),T(r,!1)},Lt=(e,t)=>{T(t,Xe(o(t),r=>{$r(r)}))};var dn=F("<label>Auto Pistol Cooldown <!></label>"),fn=F('<div style="will-change: contents"> <!></div>'),vn=F('<div>Health</div> <div style="will-change: contents"> <!></div>',1),pn=F('<div style="will-change: contents"> <!></div>'),_n=F('<div>Sword</div> <label style="display: block;">Cooldown <!></label> <label style="display: block;">Fuel cost <!></label> <button style="border-radius: 9999px; border: 4px inset tomato; background-color: tomato; padding: 1em; display: block; aspect-ratio:1;">Swing</button>',1),mn=F('<div>Shield</div> <label style="display: block;">Cooldown <!></label> <label style="display: block;">Fuel cost <!></label> <label style="display:block;"> <!></label> <button style="border-radius: 9999px; border: 4px inset lightsteelblue; background-color: lightsteelblue; padding: 1em; display: block; aspect-ratio:1;">Block</button>',1),yn=F('<div style="padding: 1em; border: 2px outset;" class="svelte-1jve5dt"><!></div>'),gn=F('<a href="?"> </a>'),hn=F("<div><!></div>"),bn=F('<div style="display: flex; flex-direction: column; justify-content: start; align-items: flex-start; padding-bottom: 4em; gap:2em;" class="svelte-1jve5dt"><div class="svelte-1jve5dt"><h1 class="svelte-1jve5dt">Pilots</h1> <h2 class="svelte-1jve5dt">A game about ...?</h2></div> <div><a href="?">Cockpit</a></div> <div><a href="?">Shop</a></div> <div><a href="?">Inventory</a></div> <!> <div><a href="/design">Design notes</a></div></div>'),kn=F('<p><a href="?">Begin</a></p>'),wn=F('<p>Paused. <a href="?">Unpause</a></p>'),xn=F('<!> <div style="border:4px inset; border-radius: 1em; padding: 2em; margin: 2em;" class="svelte-1jve5dt"><h2 class="svelte-1jve5dt">Enemy</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;" class="svelte-1jve5dt"><!> <!></div></div> <h2 class="svelte-1jve5dt">Player</h2> <div style="display: grid; grid-template-columns: 1fr 1fr;" class="svelte-1jve5dt"><!> <!> <!> <!></div>',1),Pn=F('<h2 class="svelte-1jve5dt">Game over</h2> <p> </p>',1),En=F('<div class="svelte-1jve5dt"><!> <nav><a href="?">Restart</a> <a href="?">Back To Title</a> <!> <a href="?"> </a></nav></div>'),Cn=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),In=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),Sn=F(`<h2 class="svelte-1jve5dt"> </h2> <p style="padding-inline: 4em">This is your inventory where you can see your current parts. You can also rearrange your
        parts to maximize their effectiveness</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <h2 class="svelte-1jve5dt"> </h2> <p style="padding-inline: 4em">This is your enemy's inventory. Do you see what you're up against?</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a> <!></nav>`,1),Tn=(e,t,r)=>t(o(r)),Fn=F('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div> <button>Sell</button></div>'),zn=F('<h2 class="svelte-1jve5dt">The Shop</h2> <p style="padding-inline: 4em">Buy more stuff here.</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Cockpit</a> <a href="?">Back To Title</a> <!></nav>',1),An=F('<main style="width: calc(100vw - 1px); height: 100vh; display: grid; grid-template-rows: 1fr; grid-template-columns: 1fr; justify-items: center; align-items: center;" class="svelte-1jve5dt"><!></main>');function Un(e,t){$t(t,!0);const r=_=>{var m=ve();const f=U(()=>Oe(o(l),g,"autopistol"));var I=q(m);{var S=k=>{},O=k=>{var w=dn(),R=u(d(w));ke(R,{get component(){return o(f)}}),c(w),h(k,w)};N(I,k=>{o(f)?k(O,!1):k(S)})}h(_,m)},n=_=>{var m=ve();const f=U(()=>Oe(o(l),g,"health"));var I=q(m);{var S=k=>{},O=k=>{var w=fn(),R=d(w);L(()=>M(R,`Health ${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var P=u(R);ke(P,{get component(){return o(f)}}),c(w),h(k,w)};N(I,k=>{o(f)?k(O,!1):k(S)})}h(_,m)},a=_=>{var m=ve();const f=U(()=>Oe(o(l),b,"health"));var I=q(m);{var S=k=>{},O=k=>{var w=vn(),R=u(q(w),2),P=d(R);L(()=>M(P,`${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var j=u(P);ke(j,{get component(){return o(f)}}),c(R),h(k,w)};N(I,k=>{o(f)?k(O,!1):k(S)})}h(_,m)},s=_=>{var m=ve();const f=U(()=>Oe(o(l),b,"fuel"));var I=q(m);{var S=k=>{},O=k=>{var w=pn(),R=d(w);L(()=>M(R,`Fuel ${o(f).formatter(o(f).value)??""}/${o(f).max??""} `));var P=u(R);ke(P,{get component(){return o(f)}}),c(w),h(k,w)};N(I,k=>{o(f)?k(O,!1):k(S)})}h(_,m)},i=_=>{var m=ve();const f=U(()=>Oe(o(l),b,"sword")),I=U(()=>$(o(l),b,"fuel"));var S=q(m);{var O=w=>{},k=w=>{var R=_n(),P=u(q(R),2),j=u(d(P));ke(j,{get component(){return o(f)}}),c(P);var Y=u(P,2),ge=u(d(Y)),ie=U(()=>({min:o(I).min,max:o(f).costPerSwing,value:W(o(I).value,o(I).min,o(f).costPerSwing)}));ke(ge,{get component(){return o(ie)}}),c(Y);var Z=u(Y,2),X=U(()=>E(o(f).type));Z.__click=function(..._e){var me;(me=o(X))==null||me.apply(this,_e)},L(()=>Z.disabled=o(f).swinging),h(w,R)};N(S,w=>{o(f)?w(k,!1):w(O)})}h(_,m)},v=_=>{var m=ve();const f=U(()=>Oe(o(l),b,"shield")),I=U(()=>$(o(l),b,"fuel"));var S=q(m);{var O=w=>{},k=w=>{var R=mn(),P=u(q(R),2),j=u(d(P));ke(j,{get component(){return o(f)}}),c(P);var Y=u(P,2),ge=u(d(Y)),ie=U(()=>({min:o(I).min,max:o(f).costPer,value:W(o(I).value,o(I).min,o(f).costPer)}));ke(ge,{get component(){return o(ie)}}),c(Y);var Z=u(Y,2),X=d(Z),_e=u(X),me=U(()=>({min:0,max:o(f).totalUses,value:o(f).numUses}));ke(_e,{get component(){return o(me)}}),c(Z);var we=u(Z,2),Q=U(()=>E(o(f).type));we.__click=function(...ee){var re;(re=o(Q))==null||re.apply(this,ee)},L(()=>{M(X,`${o(f).numUses??""}/${o(f).totalUses??""} `),we.disabled=o(f).blocking}),h(w,R)};N(S,w=>{o(f)?w(k,!1):w(O)})}h(_,m)},y=(_,m=Ze,f=Ze,I=Ze)=>{var S=An();const O=P=>{var j=gn();j.__click=function(...ge){var ie;(ie=I())==null||ie.apply(this,ge)};var Y=d(j,!0);c(j),L(()=>M(Y,f()?"Exit Fullscreen":"Fullscreen")),h(P,j)};var k=d(S);{var w=P=>{var j=bn(),Y=u(d(j),2),ge=d(Y);ge.__click=[Dt,C,l,p,x],c(Y);var ie=u(Y,2),Z=d(ie);Z.__click=[un,C,x],c(ie);var X=u(ie,2),_e=d(X);_e.__click=[ln,C,x],c(X);var me=u(X,2);{var we=Q=>{var ee=hn(),re=d(ee);O(re),c(ee),h(Q,ee)};N(me,Q=>{m()&&Q(we)})}Cr(2),c(j),h(P,j)},R=P=>{var j=ve(),Y=q(j);{var ge=Z=>{var X=En(),_e=d(X);{var me=G=>{var se=kn(),be=d(se);be.__click=[Dt,C,l,p,x],c(se),h(G,se)},we=G=>{var se=ve(),be=q(se);{var Me=K=>{var A=xn(),B=q(A);{var J=at=>{var ot=wn(),rr=u(d(ot));rr.__click=[Lt,l],c(ot),h(at,ot)};N(B,at=>{o(l).round.state==="paused"&&at(J)})}var D=u(B,2),V=u(d(D),2),le=d(V);De(le,()=>n);var de=u(le,2);De(de,()=>r),c(V),c(D);var fe=u(D,4),ne=d(fe);De(ne,()=>a);var ue=u(ne,2);De(ue,()=>s);var ce=u(ue,2);De(ce,()=>i);var Se=u(ce,2);De(Se,()=>v),c(fe),h(K,A)},Be=K=>{var A=ve(),B=q(A);{var J=D=>{var V=Pn(),le=u(q(V),2),de=d(le);c(le),L(()=>M(de,`Reason: ${o(l).round.reason??""}`)),h(D,V)};N(B,D=>{o(l).round.state==="over"&&D(J)},!0)}h(K,A)};N(be,K=>{o(l).round.state==="occurring"||o(l).round.state==="paused"?K(Me):K(Be,!1)},!0)}h(G,se)};N(_e,G=>{o(l).round.state==="not yet started"?G(me):G(we,!1)})}var Q=u(_e,2),ee=d(Q);ee.__click=[cn,l,p,x];var re=u(ee,2);re.__click=[_t,C,x];var Ae=u(re,2);{var he=G=>{O(G)};N(Ae,G=>{m()&&G(he)})}var ye=u(Ae,2);ye.__click=[Lt,l];var Ie=d(ye,!0);c(ye),c(Q),c(X),L(()=>M(Ie,o(te)?"Unpause (Paused)":"Pause")),h(Z,X)},ie=Z=>{var X=ve(),_e=q(X);{var me=Q=>{var ee=Sn(),re=q(ee),Ae=d(re);L(()=>M(Ae,`${Ne(o(l),b).debug??""}'s Inventory`)),c(re);var he=u(re,4);ut(he,21,()=>o(l).parts.filter(({entityId:A})=>A===b),lt,(A,B)=>{var J=Cn(),D=d(J),V=d(D),le=d(V,!0);c(V);var de=u(V,2),fe=d(de,!0);c(de),c(D);var ne=u(D,2);Re(ne,"font-size","0.8em");var ue=d(ne),ce=u(ue);Re(ce,"font-size","0.8em");var Se=d(ce,!0);L(()=>M(Se,o(B).components.join(" "))),c(ce),c(ne),c(J),L(()=>{M(le,o(B).title),M(fe,o(B).description),M(ue,`${o(B).type??""} `)}),h(A,J)}),c(he);var ye=u(he,2),Ie=d(ye);L(()=>M(Ie,`${Ne(o(l),g).debug??""}'s Inventory`)),c(ye);var G=u(ye,4);ut(G,21,()=>o(l).parts.filter(({entityId:A})=>A===g),lt,(A,B)=>{var J=In(),D=d(J),V=d(D),le=d(V,!0);c(V);var de=u(V,2),fe=d(de,!0);c(de),c(D);var ne=u(D,2);Re(ne,"font-size","0.8em");var ue=d(ne),ce=u(ue);Re(ce,"font-size","0.8em");var Se=d(ce,!0);L(()=>M(Se,o(B).components.join(" "))),c(ce),c(ne),c(J),L(()=>{M(le,o(B).title),M(fe,o(B).description),M(ue,`${o(B).type??""} `)}),h(A,J)}),c(G);var se=u(G,2),be=d(se);be.__click=[Nt,C,x];var Me=u(be,2);Me.__click=[_t,C,x];var Be=u(Me,2);{var K=A=>{O(A)};N(Be,A=>{m()&&A(K)})}c(se),h(Q,ee)},we=Q=>{var ee=ve(),re=q(ee);{var Ae=he=>{var ye=zn(),Ie=u(q(ye),4);ut(Ie,21,()=>o(l).parts.filter(({entityId:K})=>K===b),lt,(K,A)=>{var B=Fn(),J=d(B),D=d(J),V=d(D,!0);c(D);var le=u(D,2),de=d(le,!0);c(le),c(J);var fe=u(J,2);Re(fe,"font-size","0.8em");var ne=d(fe),ue=u(ne);Re(ue,"font-size","0.8em");var ce=d(ue,!0);L(()=>M(ce,o(A).components.join(" "))),c(ue),c(fe);var Se=u(fe,2);Se.__click=[Tn,z,A],c(B),L(()=>{M(V,o(A).title),M(de,o(A).description),M(ne,`${o(A).type??""} `)}),h(K,B)}),c(Ie);var G=u(Ie,2),se=d(G);se.__click=[Nt,C,x];var be=u(se,2);be.__click=[_t,C,x];var Me=u(be,2);{var Be=K=>{O(K)};N(Me,K=>{m()&&K(Be)})}c(G),h(he,ye)};N(re,he=>{o(C)==="store"&&he(Ae)},!0)}h(Q,ee)};N(_e,Q=>{o(C)==="inventory"?Q(me):Q(we,!1)},!0)}h(Z,X)};N(Y,Z=>{o(C)==="play"?Z(ge):Z(ie,!1)},!0)}h(P,j)};N(k,P=>{o(C)==="entry"?P(w):P(R,!1)})}c(S),h(_,S)},E=_=>m=>{T(l,Xe(o(l),f=>{dt(f,{entityId:b,type:_,value:"buttonPressed",time:Ce()})}))},z=_=>{T(l,Xe(o(l),m=>{Hr(m,_.entityId,_.type)}))},p=jr(),b=Ft(p,"Player");Ge(p,b,"core"),Ge(p,b,"sword"),Ge(p,b,"shield");const g=Ft(p,"Enemy");Ge(p,g,"core"),Ge(p,g,"autopistol"),dt(p,{entityId:b,type:"targeter",value:g,time:Ce()}),dt(p,{entityId:g,type:"targeter",value:b,time:Ce()});let l=Ee(p),x=Ee(!1);Er(()=>{let _=!1;const m=()=>{o(x)&&T(l,Xe(o(l),f=>{Wr(f)})),_||requestAnimationFrame(m)};return requestAnimationFrame(m),()=>{_=!0}});let C=Ee("entry");const te=U(()=>o(l).round.state==="paused");Nr(e,{fullscreenable:y}),jt()}Gt(["click"]);export{Un as component};
