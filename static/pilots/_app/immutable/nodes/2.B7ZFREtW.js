import{a as x,t as C,c as $e}from"../chunks/disclose-version.Chs3MZKY.js";import{h as fe,C as ot,Q as ar,a0 as ir,A as sr,b as or,z as lr,_ as qt,H as ur,B as Et,D as lt,c as Be,W as cr,as as Ye,F as Gt,a as Ht,G as fr,w as Pt,at as dr,au as vr,Z as _r,av as yr,d as pr,O as hr,an as mr,s as It,aw as gr,ax as br,ay as xr,T as kr,az as wr,aA as Er,y as Pr,aB as Ir,p as Yt,a6 as A,i as Wt,r as P,v as s,ar as me,a7 as d,a9 as _,a8 as c,a5 as Te,u as Tr,n as Tt,g as ee}from"../chunks/runtime.CSRt9162.js";import{d as Kt,s as g}from"../chunks/render.DcD97Zrb.js";import{i as ue,b as Cr,p as Sr}from"../chunks/this.BO0ZuxZE.js";import{s as Fr}from"../chunks/snippet.CJ2BZSP8.js";import{o as zr}from"../chunks/index-client.DfJaYR9E.js";let Ct=!1;function Ar(){Ct||(Ct=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function Me(e,t){return t}function Mr(e,t,r,n){for(var a=[],i=t.length,o=0;o<i;o++)vr(t[o].e,a,!0);var u=i>0&&a.length===0&&r!==null;if(u){var l=r.parentNode;_r(l),l.append(r),n.clear(),he(e,t[0].prev,t[i-1].next)}yr(a,()=>{for(var b=0;b<i;b++){var k=t[b];u||(n.delete(k.k),he(e,k.prev,k.next)),pr(k.e,!u)}})}function Re(e,t,r,n,a,i=null){var o=e,u={flags:t,items:new Map,first:null};{var l=e;o=fe?ot(ar(l)):l.appendChild(ir())}fe&&sr();var b=null,k=!1;or(()=>{var p=r(),I=lr(p)?p:p==null?[]:qt(p),y=I.length;if(k&&y===0)return;k=y===0;let f=!1;if(fe){var m=o.data===ur;m!==(y===0)&&(o=Et(),ot(o),lt(!1),f=!0)}if(fe){for(var E=null,T,h=0;h<y;h++){if(Be.nodeType===8&&Be.data===cr){o=Be,f=!0,lt(!1);break}var $=I[h],ze=n($,h);T=Zt(Be,u,E,null,$,ze,h,a,t),u.items.set(ze,T),E=T}y>0&&ot(Et())}if(!fe){var de=hr;Rr(I,u,o,a,t,(de.f&Ye)!==0,n)}i!==null&&(y===0?b?Gt(b):b=Ht(()=>i(o)):b!==null&&fr(b,()=>{b=null})),f&&lt(!0),r()}),fe&&(o=Be)}function Rr(e,t,r,n,a,i,o,u){var l=e.length,b=t.items,k=t.first,p=k,I,y=null,f=[],m=[],E,T,h,$;for($=0;$<l;$+=1){if(E=e[$],T=o(E,$),h=b.get(T),h===void 0){var ze=p?p.e.nodes_start:r;y=Zt(ze,t,y,y===null?t.first:y.next,E,T,$,n,a),b.set(T,y),f=[],m=[],p=y.next;continue}if(Or(h,E,$),h.e.f&Ye&&Gt(h.e),h!==p){if(I!==void 0&&I.has(h)){if(f.length<m.length){var de=m[0],M;y=de.prev;var ae=f[0],ie=f[f.length-1];for(M=0;M<f.length;M+=1)St(f[M],de,r);for(M=0;M<m.length;M+=1)I.delete(m[M]);he(t,ae.prev,ie.next),he(t,y,ae),he(t,ie,de),p=de,y=ie,$-=1,f=[],m=[]}else I.delete(h),St(h,p,r),he(t,h.prev,h.next),he(t,h,y===null?t.first:y.next),he(t,y,h),y=h;continue}for(f=[],m=[];p!==null&&p.k!==T;)(i||!(p.e.f&Ye))&&(I??(I=new Set)).add(p),m.push(p),p=p.next;if(p===null)continue;h=p}f.push(h),y=h,p=h.next}if(p!==null||I!==void 0){for(var be=I===void 0?[]:qt(I);p!==null;)(i||!(p.e.f&Ye))&&be.push(p),p=p.next;var xe=be.length;if(xe>0){var X=l===0?r:null;Mr(t,be,X,b)}}Pt.first=t.first&&t.first.e,Pt.last=y&&y.e}function Or(e,t,r,n){dr(e.v,t),e.i=r}function Zt(e,t,r,n,a,i,o,u,l,b){var k=(l&br)!==0,p=(l&xr)===0,I=k?p?mr(a):It(a):a,y=l&gr?It(o):o,f={i:y,v:I,k:i,a:null,e:null,prev:r,next:n};try{return f.e=Ht(()=>u(e,I,y),fe),f.e.prev=r&&r.e,f.e.next=n&&n.e,r===null?t.first=f:(r.next=f,r.e.next=f.e),n!==null&&(n.prev=f,n.e.prev=f.e),f}finally{}}function St(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,a=t?t.e.nodes_start:r,i=e.e.nodes_start;i!==n;){var o=kr(i);a.before(i),i=o}}function he(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Ft(e){if(fe){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;re(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var a=e.checked;re(e,"checked",null),e.checked=a}}};e.__on_r=r,wr(r),Ar()}}function He(e,t){var r=e.__attributes??(e.__attributes={});r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t)}function re(e,t,r,n){var a=e.__attributes??(e.__attributes={});fe&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[Er]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Dr(e).includes(t)?e[t]=r:e.setAttribute(t,r))}var zt=new Map;function Dr(e){var t=zt.get(e.nodeName);if(t)return t;zt.set(e.nodeName,t=[]);for(var r,n=e,a=Element.prototype;a!==n;){r=Ir(n);for(var i in r)r[i].set&&t.push(i);n=Pr(n)}return t}function jr(e,t,r){if(r){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}function te(e,t,r,n){var a=e.__styles??(e.__styles={});a[t]!==r&&(a[t]=r,r==null?e.style.removeProperty(t):e.style.setProperty(t,r,""))}var Lr=C('<button class="svelte-1ypk9ft"><i class="material-icons md-36"> </i></button>'),Nr=C('<div class="fs svelte-1ypk9ft"><!> <!></div>');function $r(e,t){Yt(t,!0);let r=me(!1),n=me(null);const a=()=>{};let i=me(a),o=me(a),u=me(!1);zr(()=>{P(o,()=>{(s(n).requestFullscreen||s(n).mozRequestFullScreen||s(n).webkitRequestFullscreen||s(n).msRequestFullscreen||a).bind(s(n))()}),P(i,Sr((document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen||a).bind(document))),P(u,!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled));const f=document.createElement("link");return f.rel="stylesheet",f.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(f),()=>{f.parentNode.removeChild(f)}});const l=()=>{s(u)&&(s(r)?s(i)():s(o)(s(n)),P(r,!s(r)))};let b=Te(()=>s(r)?"fullscreen_exit":"fullscreen");var k=Nr(),p=d(k);Fr(p,()=>t.fullscreenable,()=>s(u),()=>l);var I=_(p,2);{var y=f=>{var m=Lr();m.__click=l;var E=d(m),T=d(E,!0);c(E),c(m),A(()=>g(T,s(b))),x(f,m)};ue(I,f=>{!t.fullscreenable&&s(u)&&f(y)})}c(k),Cr(k,f=>P(n,f),()=>s(n)),A(()=>jr(k,"isFull",s(r))),x(e,k),Wt()}Kt(["click"]);const Br=e=>Math.floor(Math.random()*e),Ur=e=>e[Br(e.length)],ce=(e,t,r)=>Math.min(r,Math.max(e,t)),ut=25,qr={core:{type:"core",components:["targeter","health"],title:"Core",description:"Processing, control, mechanical center"},bipedalLegs:{type:"bipedalLegs",components:["fuel","stance"],title:"Legs",description:"Stand, shift, and shuffle on two feet"},handgun:{type:"handgun",components:["handgun","targeter","health"],title:"Gun",description:"Chk chk boom"},taser:{type:"taser",components:["targeter","taser","generator","battery"],title:"Taser",description:"Zzztt"},hackingModule:{type:"hackingModule",components:["targeter","hackingModule","generator","battery"],title:"Taser",description:"Zzztt"}},Ue=()=>({parentType:"resource",min:0,max:100,value:100,velocity:0,formatter:e=>Math.trunc(e)}),ct=()=>({parentType:"input",min:0,max:100,value:100,formatter:e=>Math.trunc(e)}),Gr={fuel:{type:"fuel",...Ue(),max:1e3,value:1e3,velocity:1},battery:{type:"battery",...Ue(),max:1e3,value:200,velocity:-1},generator:{type:"generator",...ct(),max:3,value:1,fuelCost:1,batteryGenerationAmount:1,chargeExponent:1.1},taser:{type:"taser",...ct(),max:1,value:0,batteryCostRatio:16,damageScaleExponent:1e-4},health:{type:"health",...Ue()},handgun:{type:"handgun",...Ue(),max:3,costPerShot:3,powerPerShot:5,value:0,velocity:.01},stance:{type:"stance",...ct(),min:-1,max:1,value:0},targeter:{type:"targeter",parentType:"unique",targetEntityId:null},hackingModule:{type:"hackingModule",...Ue(),value:0,max:100,velocity:1,chargeCost:16,phase:"scanning components",targetedComponentType:null,successChance:.8,resourceLossRatio:6}},ne=(e,t,r)=>{e.log.push({timestamp:ge(),entry:r,level:t}),console.log("Log",e.log.at(-1))},Hr=()=>{const e=ge();return{mostRecentUpdate:e,round:{state:"not yet started"},log:[],inputChanges:[],remainingLag:0,gameStartedTime:e,entities:[],components:[],parts:[],optimistic:[]}},K=(e,t,r)=>{const n=e.components.find(a=>a.entityId===t&&a.type===r);if(!n){const a=Oe(e,t);throw new Error(`${r}' required for '${a==null?void 0:a.debug}' (${a==null?void 0:a.entityId})`)}return Zr(n,r)},Oe=(e,t)=>{let r=e.entities.find(n=>n.entityId===t);return r||(r={debug:"Unknown entity",entityId:-1}),r},At=(e,t)=>e.components.filter(r=>r.parentType==="resource"&&r.entityId===t),Mt=(e,t)=>e.components.filter(r=>r.parentType==="input"&&r.entityId===t),ge=()=>Math.trunc(performance.now()),Xt=e=>{const t=ge();return{...e,round:{state:"occurring"},log:[],gameStartedTime:t,mostRecentUpdate:t}};let Yr=0;const Rt=(e,t)=>{let r=Yr++;return e.entities.push({entityId:r,debug:t}),r},Ie=(e,t,r)=>{const n=qr[r];e.parts.push({...n,entityId:t}),n.components.forEach(a=>{Qt(e,t,a)})},Wr=(e,t,r)=>{e.parts=e.parts.filter(n=>!(t===n.entityId&&r===n.type)),Kr(e,t)},Kr=(e,t)=>{e.components=e.components.filter(r=>r.entityId!==t),e.parts.filter(r=>r.entityId===t).forEach(r=>r.components.forEach(n=>{Qt(e,r.entityId,n)}))},Qt=(e,t,r)=>{{let n=Gr[r];if(!n)throw new Error;if(e.components.find(i=>i.entityId===t&&i.type==r))return;let a={...n,entityId:t};e.components.push(a)}};function Zr(e,t){if(!e)throw new Error;if(e.type!==t)throw Error(`expected tag ${t} but was ${e.type}`);return e}const ft=(e,t)=>{e.inputChanges.push(t)},Xr=e=>{const r=ge()-e.mostRecentUpdate;e.mostRecentUpdate=ge(),e.remainingLag+=r;let n=0;for(;e.remainingLag>=ut;)if(Qr(e),n++,e.remainingLag-=ut,n>100){ne(e,"debug","Lag recovery spinout");break}n>1&&ne(e,"debug",`Updated ${n} times to recover from lag`);const a=e.remainingLag/ut;Jr(e,a)},Ot=(e,t,r)=>{t&&(e.round={state:"over",reason:r})},Qr=e=>{for(;e.inputChanges.length>0;){const t=e.inputChanges.shift(),r=K(e,t.entityId,t.type);if(!r)throw new Error;if(r.parentType==="input")r.value=ce(t.value,r.min,r.max);else if(r.type==="targeter")r.targetEntityId=t.value;else throw new Error(`Unhandled input type '${t.type}'`);ne(e,"debug",`Updated ${t.type} to value ${t.value}`)}e.round.state==="occurring"&&e.components.forEach(t=>{switch(t.parentType){case"resource":{switch(t.type){case"handgun":{if(t.value<t.costPerShot)break;t.value=t.value-t.costPerShot;const r=K(e,t.entityId,"targeter");if(r.targetEntityId===null)break;const n=K(e,r.targetEntityId,"health");if(n.value===null)break;n.value-=t.powerPerShot,Ot(e,n.value<=0,"player lost :(")}break;case"hackingModule":{if(t.value<t.max)break;const r=K(e,t.entityId,"battery");if(r.value<t.chargeCost)break;t.value=t.min;let n=!1;const a=K(e,t.entityId,"targeter");if(a.targetEntityId===null)break;if(t.phase==="attempting to disable")if(t.targetedComponentType===null)ne(e,"debug","hacking module target was null when attempting to disable"),t.phase="scanning components";else{const i=K(e,a.targetEntityId,t.targetedComponentType);if(!i)ne(e,"debug","hacking module target was unavailable when attempting to disable"),t.phase="scanning components";else{const o=Math.random()>t.successChance;switch(i.parentType){case"input":case"resource":if(o){const u=i.max-i.min,l=i.value;i.value=ce(i.value-Math.ceil(u/t.resourceLossRatio),i.min,i.max);const b=i.value;ne(e,"debug",`Successfully hacked (${l}->${b}) module type '${i.type}'`)}else ne(e,"debug",`Failed to hack module type '${i.type}'`);t.phase="scanning components",t.targetedComponentType=null,n=!0;break;default:ne(e,"debug",`hacking module target type '${i.type}' unhackable`),t.phase="scanning components",t.targetedComponentType=null;break}}}if(t.phase==="scanning components"&&!n){const i=e.components.filter(u=>u.entityId===a.targetEntityId&&(u.parentType==="resource"||u.parentType==="input"));t.targetedComponentType=Ur(i).type;const o=Oe(e,a.targetEntityId);t.phase="attempting to disable",ne(e,"debug",`hacking module targeted ${o.debug}'s '${t.targetedComponentType}'`),n=!0}n?r.value=ce(r.value-t.chargeCost,r.min,r.max):ne(e,"debug","hacking module did nothing")}break}t.value=ce(t.value+t.velocity,t.min,t.max)}break;case"input":{switch(t.type){case"taser":{if(t.value<=0)break;const a=K(e,t.entityId,"battery"),i=a.value;if(a.value==null)break;a.value=ce(a.value-t.batteryCostRatio*t.value,a.min,a.max);const o=i-a.value,u=K(e,t.entityId,"targeter");if(u.targetEntityId===null)break;const l=K(e,u.targetEntityId,"health");if(l.value===null)break;l.value-=ce(o**t.damageScaleExponent,l.min,l.max),Ot(e,l.value<=0,Oe(e,t.entityId).debug+" won!")}break;case"generator":const r=K(e,t.entityId,"fuel"),n=K(e,t.entityId,"battery");for(let a=0;a<t.value;a++){if(r.value<t.fuelCost)return;r.value=ce(r.value-t.fuelCost,r.min,r.max),n.value=ce(n.value+t.batteryGenerationAmount*(a+1)**t.chargeExponent,n.min,n.max)}}break}}})},Jr=(e,t)=>{e.optimistic={...e.components},Object.entries(e.optimistic).forEach(([r,n])=>{const{parentType:a}=n;switch(a){case"resource":n.value=ce(n.value+n.velocity*t,n.min,n.max);break}})};var Jt=Symbol.for("immer-nothing"),Dt=Symbol.for("immer-draftable"),q=Symbol.for("immer-state");function Z(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var De=Object.getPrototypeOf;function je(e){return!!e&&!!e[q]}function Se(e){var t;return e?Vt(e)||Array.isArray(e)||!!e[Dt]||!!((t=e.constructor)!=null&&t[Dt])||Qe(e)||Je(e):!1}var Vr=Object.prototype.constructor.toString();function Vt(e){if(!e||typeof e!="object")return!1;const t=De(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Vr}function We(e,t){Xe(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Xe(e){const t=e[q];return t?t.type_:Array.isArray(e)?1:Qe(e)?2:Je(e)?3:0}function pt(e,t){return Xe(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function er(e,t,r){const n=Xe(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function en(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Qe(e){return e instanceof Map}function Je(e){return e instanceof Set}function Ce(e){return e.copy_||e.base_}function ht(e,t){if(Qe(e))return new Map(e);if(Je(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Vt(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[q];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],u=n[o];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(n[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[o]})}return Object.create(De(e),n)}else{const n=De(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function kt(e,t=!1){return Ve(e)||je(e)||!Se(e)||(Xe(e)>1&&(e.set=e.add=e.clear=e.delete=tn),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>kt(n,!0))),e}function tn(){Z(2)}function Ve(e){return Object.isFrozen(e)}var rn={};function Fe(e){const t=rn[e];return t||Z(0,e),t}var qe;function tr(){return qe}function nn(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function jt(e,t){t&&(Fe("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function mt(e){gt(e),e.drafts_.forEach(an),e.drafts_=null}function gt(e){e===qe&&(qe=e.parent_)}function Lt(e){return qe=nn(qe,e)}function an(e){const t=e[q];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Nt(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[q].modified_&&(mt(t),Z(4)),Se(e)&&(e=Ke(t,e),t.parent_||Ze(t,e)),t.patches_&&Fe("Patches").generateReplacementPatches_(r[q].base_,e,t.patches_,t.inversePatches_)):e=Ke(t,r,[]),mt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Jt?e:void 0}function Ke(e,t,r){if(Ve(t))return t;const n=t[q];if(!n)return We(t,(a,i)=>$t(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ze(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,o=!1;n.type_===3&&(i=new Set(a),a.clear(),o=!0),We(i,(u,l)=>$t(e,n,a,u,l,r,o)),Ze(e,a,!1),r&&e.patches_&&Fe("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function $t(e,t,r,n,a,i,o){if(je(a)){const u=i&&t&&t.type_!==3&&!pt(t.assigned_,n)?i.concat(n):void 0,l=Ke(e,a,u);if(er(r,n,l),je(l))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Se(a)&&!Ve(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Ke(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ze(e,a)}}function Ze(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&kt(t,r)}function sn(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:tr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=wt;r&&(a=[n],i=Ge);const{revoke:o,proxy:u}=Proxy.revocable(a,i);return n.draft_=u,n.revoke_=o,u}var wt={get(e,t){if(t===q)return e;const r=Ce(e);if(!pt(r,t))return on(e,r,t);const n=r[t];return e.finalized_||!Se(n)?n:n===dt(e.base_,t)?(vt(e),e.copy_[t]=xt(n,e)):n},has(e,t){return t in Ce(e)},ownKeys(e){return Reflect.ownKeys(Ce(e))},set(e,t,r){const n=rr(Ce(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=dt(Ce(e),t),i=a==null?void 0:a[q];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(en(r,a)&&(r!==void 0||pt(e.base_,t)))return!0;vt(e),bt(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return dt(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,vt(e),bt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ce(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Z(11)},getPrototypeOf(e){return De(e.base_)},setPrototypeOf(){Z(12)}},Ge={};We(wt,(e,t)=>{Ge[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ge.deleteProperty=function(e,t){return Ge.set.call(this,e,t,void 0)};Ge.set=function(e,t,r){return wt.set.call(this,e[0],t,r,e[0])};function dt(e,t){const r=e[q];return(r?Ce(r):e)[t]}function on(e,t,r){var a;const n=rr(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function rr(e,t){if(!(t in e))return;let r=De(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=De(r)}}function bt(e){e.modified_||(e.modified_=!0,e.parent_&&bt(e.parent_))}function vt(e){e.copy_||(e.copy_=ht(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var ln=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(l=i,...b){return o.produce(l,k=>r.call(this,k,...b))}}typeof r!="function"&&Z(6),n!==void 0&&typeof n!="function"&&Z(7);let a;if(Se(t)){const i=Lt(this),o=xt(t,void 0);let u=!0;try{a=r(o),u=!1}finally{u?mt(i):gt(i)}return jt(i,n),Nt(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Jt&&(a=void 0),this.autoFreeze_&&kt(a,!0),n){const i=[],o=[];Fe("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else Z(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...u)=>this.produceWithPatches(o,l=>t(l,...u));let n,a;return[this.produce(t,r,(o,u)=>{n=o,a=u}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Se(e)||Z(8),je(e)&&(e=un(e));const t=Lt(this),r=xt(e,void 0);return r[q].isManual_=!0,gt(t),r}finishDraft(e,t){const r=e&&e[q];(!r||!r.isManual_)&&Z(9);const{scope_:n}=r;return jt(n,t),Nt(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Fe("Patches").applyPatches_;return je(e)?n(e,t):this.produce(e,a=>n(a,t))}};function xt(e,t){const r=Qe(e)?Fe("MapSet").proxyMap_(e,t):Je(e)?Fe("MapSet").proxySet_(e,t):sn(e,t);return(t?t.scope_:tr()).drafts_.push(r),r}function un(e){return je(e)||Z(10,e),nr(e)}function nr(e){if(!Se(e)||Ve(e))return e;const t=e[q];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ht(e,t.scope_.immer_.useStrictShallowCopy_)}else r=ht(e,!0);return We(r,(n,a)=>{er(r,n,nr(a))}),t&&(t.finalized_=!1),r}var G=new ln,_t=G.produce;G.produceWithPatches.bind(G);G.setAutoFreeze.bind(G);G.setUseStrictShallowCopy.bind(G);G.applyPatches.bind(G);G.createDraft.bind(G);G.finishDraft.bind(G);const Bt=(e,t,r,n,a)=>{P(t,"play"),P(r,Xt(n)),P(a,!0)},cn=(e,t,r)=>{P(t,"inventory"),P(r,!1)},fn=(e,t,r)=>{P(t,"store"),P(r,!1)},dn=(e,t,r,n)=>{P(t,Xt(r)),P(n,!0)},Ut=(e,t,r)=>{P(t,"play"),P(r,!0)},yt=(e,t)=>{P(t,"entry")};var vn=C(`<div style="width:100%;height: 100%; display: flex; flex-direction:
			column; justify-content: space-between; align-items: center; padding-bottom: 4em;"><h1 class="svelte-11bju47">Welcome</h1> <div><a href="?">Play</a></div> <div><a href="?">Shop</a></div> <div><a href="?">Inventory</a></div></div>`),_n=C('<p><a href="?">Begin</a></p>'),yn=C("<tr><td></td><td> </td><td> </td><td> </td><td> </td><td> </td><td><meter> </meter></td></tr>"),pn=C('<label style="display:flex; flex-direction: row; justify-content: space-between;"> <input disabled type="range"></label>'),hn=C("<tr><td></td><td> </td><td> </td><td> </td><td> </td><td> </td><td><meter> </meter></td></tr>"),mn=C('<label style="display:flex; flex-direction: row; justify-content: space-between;"> <input type="range"></label>'),gn=C('<h2 class="svelte-11bju47">Enemy</h2> <table class="svelte-11bju47"><thead><tr><th class="svelte-11bju47">#</th><th class="svelte-11bju47">Entity</th><th class="svelte-11bju47">Type</th><th class="svelte-11bju47">Value</th><th class="svelte-11bju47">Min</th><th class="svelte-11bju47">Max</th><th class="svelte-11bju47">Meter</th></tr></thead><tbody></tbody></table> <div style="display: flex; flex-direction: column;"></div> <h2 class="svelte-11bju47">Player</h2> <table class="svelte-11bju47"><thead><tr><th class="svelte-11bju47">#</th><th class="svelte-11bju47">Entity</th><th class="svelte-11bju47">Type</th><th class="svelte-11bju47">Value</th><th class="svelte-11bju47">Min</th><th class="svelte-11bju47">Max</th><th class="svelte-11bju47">Meter</th></tr></thead><tbody></tbody></table> <div style="display: flex; flex-direction: column;"></div>',1),bn=C('<h2 class="svelte-11bju47">Game over</h2> <p> </p>',1),xn=C('<a href="?">Toggle Fullscreen</a>'),kn=C('<!> <nav><a href="?">Restart</a> <a href="?">Back To Title</a> <!></nav>',1),wn=C('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div></div>'),En=C(`<h2 class="svelte-11bju47"> </h2> <p style="padding-inline: 4em">This is your inventory where you can see your current parts. You can also rearrange your
        parts to maximize their effectiveness</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Round</a> <a href="?">Back To Title</a></nav>`,1),Pn=(e,t,r)=>t(s(r)),In=C('<div style="display: flex; flex-direction: column; gap: 1em; border: 2px outset; padding-inline: 0.4em; padding-block: 0.4em;"><div style="display: flex; gap: 1em; flex-direction: row;"><div style="width: 30%; font-size: 1.4em"> </div> <div> </div></div> <div> <span> </span></div> <button>Sell</button></div>'),Tn=C('<h2 class="svelte-11bju47">The Shop</h2> <p style="padding-inline: 4em">Buy more stuff here.</p> <div style="display: flex; flex-direction: column; gap: 0.4em;"></div> <nav><a href="?">Back To Round</a> <a href="?">Back To Title</a></nav>',1),Cn=C(`<div style="width:100%;height: 100%; display: flex; flex-direction:
			column; gap:2em;"><!></div>`);function On(e,t){Yt(t,!0);const r=(m,E=Tt,T=Tt)=>{var h=Cn(),$=d(h);{var ze=M=>{var ae=vn(),ie=_(d(ae),2),be=d(ie);be.__click=[Bt,f,l,i,y],c(ie);var xe=_(ie,2),X=d(xe);X.__click=[fn,f,y],c(xe);var ve=_(xe,2),Ae=d(ve);Ae.__click=[cn,f,y],c(ve),c(ae),x(M,ae)},de=M=>{var ae=$e(),ie=ee(ae);{var be=X=>{var ve=kn(),Ae=ee(ve);{var et=S=>{var F=_n(),Q=d(F);Q.__click=[Bt,f,l,i,y],c(F),x(S,F)},tt=S=>{var F=$e(),Q=ee(F);{var Y=L=>{var R=gn(),B=_(ee(R),2),J=_(d(B));Re(J,21,()=>s(k),Me,(z,v,O)=>{var D=yn(),w=d(D);w.textContent=O+1;var W=_(w),ke=d(W,!0);A(()=>g(ke,Oe(s(l),s(v).entityId).debug)),c(W);var U=_(W),rt=d(U,!0);c(U);var we=_(U),nt=d(we,!0);A(()=>g(nt,s(v).formatter(s(v).value))),c(we);var Ee=_(we),at=d(Ee,!0);c(Ee);var Pe=_(Ee),it=d(Pe,!0);c(Pe);var Ne=_(Pe),j=d(Ne),st=d(j);c(j),c(Ne),c(D),A(()=>{g(rt,s(v).type),g(at,s(v).min),g(it,s(v).max),re(j,"min",s(v).min),re(j,"max",s(v).max),He(j,s(v).value),te(j,"width","100%"),te(j,"transform","scaleY(2)"),g(st,`${s(v).value??""} of ${s(v).max??""}`)}),x(z,D)}),c(J),c(B);var N=_(B,2);Re(N,21,()=>s(I),Me,(z,v)=>{var O=pn(),D=d(O),w=_(D);Ft(w);var W=Te(()=>n(s(v).type));w.__input=function(...ke){var U;(U=s(W))==null||U.apply(this,ke)},c(O),A(()=>{g(D,`${s(v).type??""} (${s(v).value??""}/${s(v).max??""}) `),re(w,"min",s(v).min),re(w,"max",s(v).max),He(w,s(v).value),te(w,"transform","scaleY(2)")}),x(z,O)}),c(N);var V=_(N,4),H=_(d(V));Re(H,21,()=>s(b),Me,(z,v,O)=>{var D=hn(),w=d(D);w.textContent=O+1;var W=_(w),ke=d(W,!0);A(()=>g(ke,Oe(s(l),s(v).entityId).debug)),c(W);var U=_(W),rt=d(U,!0);c(U);var we=_(U),nt=d(we,!0);A(()=>g(nt,s(v).formatter(s(v).value))),c(we);var Ee=_(we),at=d(Ee,!0);c(Ee);var Pe=_(Ee),it=d(Pe,!0);c(Pe);var Ne=_(Pe),j=d(Ne),st=d(j);c(j),c(Ne),c(D),A(()=>{g(rt,s(v).type),g(at,s(v).min),g(it,s(v).max),re(j,"min",s(v).min),re(j,"max",s(v).max),He(j,s(v).value),te(j,"width","100%"),te(j,"transform","scaleY(2)"),g(st,`${s(v).value??""} of ${s(v).max??""}`)}),x(z,D)}),c(H),c(V);var le=_(V,2);Re(le,21,()=>s(p),Me,(z,v)=>{var O=mn(),D=d(O),w=_(D);Ft(w);var W=Te(()=>n(s(v).type));w.__input=function(...ke){var U;(U=s(W))==null||U.apply(this,ke)},c(O),A(()=>{g(D,`${s(v).type??""} (${s(v).value??""}/${s(v).max??""}) `),re(w,"min",s(v).min),re(w,"max",s(v).max),He(w,s(v).value),te(w,"transform","scaleY(2)")}),x(z,O)}),c(le),x(L,R)},pe=L=>{var R=$e(),B=ee(R);{var J=N=>{var V=bn(),H=_(ee(V),2),le=d(H);c(H),A(()=>g(le,`Reason: ${s(l).round.reason??""}`)),x(N,V)};ue(B,N=>{s(l).round.state==="over"&&N(J)},!0)}x(L,R)};ue(Q,L=>{s(l).round.state==="occurring"?L(Y):L(pe,!1)},!0)}x(S,F)};ue(Ae,S=>{s(l).round.state==="not yet started"?S(et):S(tt,!1)})}var se=_(Ae,2),_e=d(se);_e.__click=[dn,l,i,y];var ye=_(_e,2);ye.__click=[yt,f];var Le=_(ye,2);{var oe=S=>{var F=xn();F.__click=function(...Q){var Y;(Y=T())==null||Y.apply(this,Q)},x(S,F)};ue(Le,S=>{E()&&S(oe)})}c(se),x(X,ve)},xe=X=>{var ve=$e(),Ae=ee(ve);{var et=se=>{var _e=En(),ye=ee(_e),Le=d(ye);A(()=>g(Le,`${Oe(s(l),o).debug??""}'s Inventory`)),c(ye);var oe=_(ye,4);Re(oe,21,()=>s(l).parts.filter(({entityId:Y})=>Y===o),Me,(Y,pe)=>{var L=wn(),R=d(L),B=d(R),J=d(B,!0);c(B);var N=_(B,2),V=d(N,!0);c(N),c(R);var H=_(R,2);te(H,"font-size","0.8em");var le=d(H),z=_(le);te(z,"font-size","0.8em");var v=d(z,!0);A(()=>g(v,s(pe).components.join(" "))),c(z),c(H),c(L),A(()=>{g(J,s(pe).title),g(V,s(pe).description),g(le,`${s(pe).type??""} `)}),x(Y,L)}),c(oe);var S=_(oe,2),F=d(S);F.__click=[Ut,f,y];var Q=_(F,2);Q.__click=[yt,f],c(S),x(se,_e)},tt=se=>{var _e=$e(),ye=ee(_e);{var Le=oe=>{var S=Tn(),F=_(ee(S),4);Re(F,21,()=>s(l).parts.filter(({entityId:L})=>L===o),Me,(L,R)=>{var B=In(),J=d(B),N=d(J),V=d(N,!0);c(N);var H=_(N,2),le=d(H,!0);c(H),c(J);var z=_(J,2);te(z,"font-size","0.8em");var v=d(z),O=_(v);te(O,"font-size","0.8em");var D=d(O,!0);A(()=>g(D,s(R).components.join(" "))),c(O),c(z);var w=_(z,2);w.__click=[Pn,a,R],c(B),A(()=>{g(V,s(R).title),g(le,s(R).description),g(v,`${s(R).type??""} `)}),x(L,B)}),c(F);var Q=_(F,2),Y=d(Q);Y.__click=[Ut,f,y];var pe=_(Y,2);pe.__click=[yt,f],c(Q),x(oe,S)};ue(ye,oe=>{s(f)==="store"&&oe(Le)},!0)}x(se,_e)};ue(Ae,se=>{s(f)==="inventory"?se(et):se(tt,!1)},!0)}x(X,ve)};ue(ie,X=>{s(f)==="play"?X(be):X(xe,!1)},!0)}x(M,ae)};ue($,M=>{s(f)==="entry"?M(ze):M(de,!1)})}c(h),x(m,h)},n=m=>E=>{P(l,_t(s(l),T=>{ft(T,{entityId:o,type:m,value:Number(E.target?E.target.value:0),time:ge()})}))},a=m=>{P(l,_t(s(l),E=>{Wr(E,m.entityId,m.type)}))},i=Hr(),o=Rt(i,"Player");Ie(i,o,"core"),Ie(i,o,"taser"),Ie(i,o,"bipedalLegs"),Ie(i,o,"hackingModule");const u=Rt(i,"Enemy");Ie(i,u,"core"),Ie(i,u,"handgun"),Ie(i,u,"bipedalLegs"),ft(i,{entityId:o,type:"targeter",value:u,time:ge()}),ft(i,{entityId:u,type:"targeter",value:o,time:ge()});let l=me(i),b=Te(()=>At(s(l),o)),k=Te(()=>At(s(l),u)),p=Te(()=>Mt(s(l),o)),I=Te(()=>Mt(s(l),u)),y=me(!1);Tr(()=>{let m;const E=()=>{s(y)&&P(l,_t(s(l),T=>{Xr(T)})),m=setTimeout(E,17)};return m=setTimeout(E,0),()=>{clearTimeout(m)}});let f=me("entry");$r(e,{fullscreenable:r}),Wt()}Kt(["click","input"]);export{On as component};
